<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.353">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>STAT 340: Data Science II - 16&nbsp; Statistical Testing, Continued</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./R05_testing_Additional_Examples.html" rel="next">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./testing1.html">Testing</a></li><li class="breadcrumb-item"><a href="./testing2.html"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Statistical Testing, Continued</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">STAT 340: Data Science II</a> 
        <div class="sidebar-tools-main">
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">STAT 340 Index</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="false">
 <span class="menu-text">Sampling</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rv.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Random Variables</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./R01_RandomVariables.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Random Variables R Examples</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rv_practice.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Probability and Random Variables Practice</span></span></a>
  </div>
</li>
          <li class="px-0"><hr class="sidebar-divider hi "></li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./cov.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Independence, Conditional Probability and Bayes’ Rule</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./R02_IndepCondBayes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Independence, Conditional Probability and Bayes Theorem R Examples</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./cov_practice.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Independence and Conditional Probability Practice</span></span></a>
  </div>
</li>
          <li class="px-0"><hr class="sidebar-divider hi "></li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./mc.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Monte Carlo</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./R03_MonteCarloExamples.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Monte Carlo Examples</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./mc_practice.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Monte Carlo Practice</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./R_MonteCarlo_Battleship.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Monte Carlo Battleship</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">Testing</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./testing1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Introduction to Statistical Testing</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./R04_Monte_Carlo_Testing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Monte Carlo Testing</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./testing1_practice.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Monte Carlo Testing Practice</span></span></a>
  </div>
</li>
          <li class="px-0"><hr class="sidebar-divider hi "></li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./testing2.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Statistical Testing, Continued</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./R05_testing_Additional_Examples.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Monte Carlo Testing: Additional Examples</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./testing2_practice.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Testing and Power Practice</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="false">
 <span class="menu-text">Estimation</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./estimation1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Estimation Part 1</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./estimation1_practice.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Point Estimation Practice</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./R06_More_Estimation_Examples.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Estimation Examples</span></span></a>
  </div>
</li>
          <li class="px-0"><hr class="sidebar-divider hi "></li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./estimation2_practice.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Interval Estimation Practice</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./R07_More_Estimation_and_CI_Examples.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Interval Estimation Examples</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="false">
 <span class="menu-text">Prediction</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./slr_practice.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Simple Linear Regression Practice</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./R08_prediction_examples.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Simple Linear Regression - Examples</span></span></a>
  </div>
</li>
          <li class="px-0"><hr class="sidebar-divider hi "></li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./mlr_practice.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Multiple Linear Regression Practice</span></span></a>
  </div>
</li>
          <li class="px-0"><hr class="sidebar-divider hi "></li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./logistic_practice.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Logistic Regression Practice</span></span></a>
  </div>
</li>
          <li class="px-0"><hr class="sidebar-divider hi "></li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./cv_practice.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Cross Validation Practice</span></span></a>
  </div>
</li>
          <li class="px-0"><hr class="sidebar-divider hi "></li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./bootstrap_practice.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">Bootstrap Practice</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="false">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./RV_summary.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Random Variable Summary</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#learning-objectives" id="toc-learning-objectives" class="nav-link active" data-scroll-target="#learning-objectives"><span class="header-section-number">16.1</span> Learning objectives</a></li>
  <li><a href="#testing-and-types-of-errors" id="toc-testing-and-types-of-errors" class="nav-link" data-scroll-target="#testing-and-types-of-errors"><span class="header-section-number">16.2</span> Testing and Types of Errors</a></li>
  <li><a href="#balancing-errors" id="toc-balancing-errors" class="nav-link" data-scroll-target="#balancing-errors"><span class="header-section-number">16.3</span> Balancing errors</a></li>
  <li><a href="#testing-at-level-alpha" id="toc-testing-at-level-alpha" class="nav-link" data-scroll-target="#testing-at-level-alpha"><span class="header-section-number">16.4</span> Testing at level <span class="math inline">\(\alpha\)</span></a></li>
  <li><a href="#coinflips-revisited" id="toc-coinflips-revisited" class="nav-link" data-scroll-target="#coinflips-revisited"><span class="header-section-number">16.5</span> Coinflips revisited</a></li>
  <li><a href="#one-sided-vs-two-sided-tests" id="toc-one-sided-vs-two-sided-tests" class="nav-link" data-scroll-target="#one-sided-vs-two-sided-tests"><span class="header-section-number">16.6</span> One-sided vs two-sided tests</a>
  <ul class="collapse">
  <li><a href="#choosing-the-rejection-region" id="toc-choosing-the-rejection-region" class="nav-link" data-scroll-target="#choosing-the-rejection-region"><span class="header-section-number">16.6.1</span> Choosing the rejection region</a></li>
  </ul></li>
  <li><a href="#one-sided-vs-two-sided-tests-1" id="toc-one-sided-vs-two-sided-tests-1" class="nav-link" data-scroll-target="#one-sided-vs-two-sided-tests-1"><span class="header-section-number">16.7</span> One-sided vs two-sided tests</a></li>
  <li><a href="#test-statistics-and-where-to-find-them" id="toc-test-statistics-and-where-to-find-them" class="nav-link" data-scroll-target="#test-statistics-and-where-to-find-them"><span class="header-section-number">16.8</span> Test statistics and where to find them</a></li>
  <li><a href="#example-flipping-a-possibly-biased-coin-continued" id="toc-example-flipping-a-possibly-biased-coin-continued" class="nav-link" data-scroll-target="#example-flipping-a-possibly-biased-coin-continued"><span class="header-section-number">16.9</span> Example: flipping a (possibly biased) coin, continued</a></li>
  <li><a href="#choosing-alpha-trade-offs" id="toc-choosing-alpha-trade-offs" class="nav-link" data-scroll-target="#choosing-alpha-trade-offs"><span class="header-section-number">16.10</span> Choosing <span class="math inline">\(\alpha\)</span>: trade-offs</a></li>
  <li><a href="#review" id="toc-review" class="nav-link" data-scroll-target="#review"><span class="header-section-number">16.11</span> Review</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Statistical Testing, Continued</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p>This week, we will continue our discussion of statistical hypothesis testing. We’ll look at more complicated examples of statistical hypotheses, and introduce other ways to test those hypotheses beyond the Monte Carlo-based methods from last week. In the process, we will (finally) completely formalize the Neyman-Pearson hypothesis testing framework, and we will discuss the ways that things can go wrong when performing hypothesis testing (i.e., the types of errors we can make). We’ll see how these different kinds of errors let us compare different tests of a particular null hypothesis.</p>
<section id="learning-objectives" class="level2" data-number="16.1">
<h2 data-number="16.1" class="anchored" data-anchor-id="learning-objectives"><span class="header-section-number">16.1</span> Learning objectives</h2>
<p>After this lesson, you will be able to</p>
<ul>
<li>Explain the meaning of Type 1 and Type 2 errors in statistical hypothesis testing.</li>
<li>Explain the significance level of a test.</li>
<li>Test a simple parametric null hypothesis</li>
</ul>
</section>
<section id="testing-and-types-of-errors" class="level2" data-number="16.2">
<h2 data-number="16.2" class="anchored" data-anchor-id="testing-and-types-of-errors"><span class="header-section-number">16.2</span> Testing and Types of Errors</h2>
<p>When we perform a statistical hypothesis test and produce a p-value, this p-value denotes a probability that, if the null hypothesis were true, we would see results at least as extreme as the observed data. Except in some really extreme circumstances, this p-value is not zero. Thus, there is <strong>some</strong> probability that, even if the null hypothesis is true, we observe very unlikely data and, as a result, reject the null hypothesis incorrectly. Similarly, even if the null hypothesis is false, the data that we observe may not be “weird” enough to constitute sufficient evidence against the null hypothesis, and we may conclude, incorrectly, that the null hypothesis is true.</p>
<p>The possible outcomes are summarized in the table below. Something like this table is probably familiar to you from other classes, either in statistics or elsewhere:</p>
<p><span class="math display">\[
\begin{aligned}
                   &amp; ~~~~ {\bf H_0 \text{ true }} &amp; {\bf H_0 \text{ false} } \\
{\bf \text{Do not reject } H_0 } &amp; ~~~ \text{ True negative }  &amp; \text{ False negative } \\
{\bf \text{Reject } H_0 } &amp; ~~~ \text{ False positive } &amp; \text{ True positive }
\end{aligned}
\]</span></p>
<p>The bottom-left and top-right entries of this table are the kinds of errors we can make. In statistics, we often call them “Type I” and “Type II” errors, respectively.</p>
<p>Said another way:</p>
<ul>
<li>A <strong>Type I</strong> error corresponds to rejecting the null hypothesis when it is in fact true. That is, type I errors correspond to “false alarms”.</li>
<li>A <strong>Type II</strong> error corresponds to accepting the null hypothesis when it is <em>not</em> true. That is, type II errors correspond to “misses”.</li>
</ul>
<p><strong>Example: coin flipping</strong></p>
<p>Let’s suppose that we are flipping a coin and we want to assess whether or not the coin is fair. We model coin flips as being drawn from a Bernoulli with success parameter <span class="math inline">\(p\)</span>. A fair coin corresponds to <span class="math inline">\(p=1/2\)</span>, so our null hypothesis is <span class="math display">\[
H_0 : p = 1/2,
\]</span></p>
<p>where <span class="math inline">\(p \in [0,1]\)</span> is the probability of a coinflip landing heads.</p>
<p>We read that as something like “H nought is that <span class="math inline">\(p\)</span> is 1/2” or “the null hypothesis is that <span class="math inline">\(p=1/2\)</span>”.</p>
<p>A Type I error would correspond to the case where <span class="math inline">\(p=1/2\)</span> but we conclude incorrectly) that the coin is <em>not</em> fair, i.e., we conclude that <span class="math inline">\(p \neq 1/2\)</span>.</p>
<p>A Type II error would correspond to the case where <span class="math inline">\(p \neq 1/2\)</span> (i.e., the null hypothesis is not true), but we conclude (incorrectly!) that the coin is fair.</p>
<p><strong>Example: lady tasting more tea</strong></p>
<p>Recall our lady tasting tea example, where our null hypothesis was <span class="math display">\[
H_0 : \text{ Muriel Bristol is guessing at random }
\]</span></p>
<p>A Type I error would correspond to the case where Bristol is guessing completely randomly (i.e., cannot tell the milk-first cups from the milk-second cups), but we conclude, incorrectly, that she can tell the difference.</p>
<p>A Type II error would correspond to the case where Bristol really can tell the difference, but we incorrectly conclude that she is guessing at random.</p>
</section>
<section id="balancing-errors" class="level2" data-number="16.3">
<h2 data-number="16.3" class="anchored" data-anchor-id="balancing-errors"><span class="header-section-number">16.3</span> Balancing errors</h2>
<p>Of course, there are trade-offs involved in this Type I and Type II business.</p>
<p>One way to avoid committing a Type I error altogether is to just conduct a test wherein we <em>always accept</em> the null hypothesis. This is great, except that if the null hypothesis is <em>not</em> true, then we will commit a Type II error with probability 1.</p>
<p>In the other direction, we could design a test that always rejects the null hypothesis. Then, if the null hypothesis is true, our probability of a Type I error is <span class="math inline">\(1\)</span>, but if <span class="math inline">\(H_0\)</span> is <em>not true</em>, we will always be right!</p>
<p>This makes it clear that unless we are okay with a totally useless test, we need to balance these two types of errors against one another.</p>
<p>For a particular test, the probability that we commit a Type I error is called the <em>level</em> or <em>size</em> of the test, and is denoted by <span class="math inline">\(\alpha\)</span>.</p>
<p>The standard hypothesis testing approach is to decide, ahead of time, how large we are willing to let <span class="math inline">\(\alpha\)</span> be, and then choose the “rejection threshold” for our test statistic accordingly. That is, we specify the probability of a Type I error that we are willing to tolerate, and then adjust our test accordingly so that we reject <span class="math inline">\(H_0\)</span> (when it is true) with probability <span class="math inline">\(\alpha\)</span>.</p>
</section>
<section id="testing-at-level-alpha" class="level2" data-number="16.4">
<h2 data-number="16.4" class="anchored" data-anchor-id="testing-at-level-alpha"><span class="header-section-number">16.4</span> Testing at level <span class="math inline">\(\alpha\)</span></h2>
<p>The “standard” hypothesis testing framework says that we should set our acceptable Type I error probability <span class="math inline">\(\alpha\)</span> and then conduct our test in such a way that the probability of a Type I error is indeed <span class="math inline">\(\alpha\)</span>. Well, fair enough. Let’s use the standard <span class="math inline">\(\alpha=0.05\)</span>.</p>
<p>How do we ensure that our statistical test has level <span class="math inline">\(\alpha=0.05\)</span>?</p>
<p>The “standard” way is as follows. Suppose that our data is <span class="math inline">\(D\)</span> and our test statistic is <span class="math inline">\(T(D)\)</span>, and “extreme” or “unusual” or “weird” outcomes (i.e., observed data) correspond to larger values of <span class="math inline">\(T(D)\)</span>.</p>
<p>So our test will reject the null hypothesis for especially large values of <span class="math inline">\(T(D)\)</span>.</p>
<p>Then our aim is to find a number <span class="math inline">\(t_\alpha\)</span> such that <span class="math display">\[
\Pr[ T(D) \ge t_\alpha ; H_0 ] = \alpha,
\]</span></p>
<p>where we recall that the semicolon notation is just to denote that the probability is <em>under the null</em>, i.e., under the situation where <span class="math inline">\(H_0\)</span> is true.</p>
<p>How do we find this magic number <span class="math inline">\(t_\alpha\)</span>, which we usually call the “critical value” or “rejection threshold”?</p>
<p>Well, if we know the distribution of <span class="math inline">\(T = T(D)\)</span> under <span class="math inline">\(H_0\)</span>, then this is simple. If <span class="math inline">\(F_0\)</span> denotes the cumulative distribution function of <span class="math inline">\(T\)</span> under the null, then by definition, <span class="math display">\[
\Pr[ T &gt; t_\alpha; H_0 ] = 1 -\Pr[ T \le t_\alpha; H_0 ]  = 1- F_0( t_\alpha ).
\]</span></p>
<p><strong>Note:</strong> you might have noticed that we’re using <span class="math inline">\(T &gt; t_\alpha\)</span> instead of <span class="math inline">\(T \ge t_\alpha\)</span>, here. For continuous distributions, this distinction doesn’t really matter. But for the binomial, which is discrete, the difference does matter… For now the computation/calculation is more important. We’ll come back to the <span class="math inline">\(T &gt; t_\alpha\)</span> vs <span class="math inline">\(T \ge t_\alpha\)</span> issue.</p>
<p>So we just need to choose the critical value <span class="math inline">\(t_\alpha\)</span> in such a way that <span class="math display">\[
F_0(t_\alpha) = 1-\alpha.
\]</span></p>
<p>Let’s take a look at this in action.</p>
</section>
<section id="coinflips-revisited" class="level2" data-number="16.5">
<h2 data-number="16.5" class="anchored" data-anchor-id="coinflips-revisited"><span class="header-section-number">16.5</span> Coinflips revisited</h2>
<p>Returning to our coinflipping example, suppose that we observe a sample of 200 coinflips, which we model as <span class="math inline">\(200\)</span> independent Bernoulli random variables with success probability <span class="math inline">\(p\)</span>, and we want to test the null hypothesis <span class="math display">\[
H_0 : p=1/2.
\]</span></p>
<p>The first thing we need to do is choose a measure of how “unusual” a particular observation is. That is, we need to specify our test statistic.</p>
<p>A natural choice of test statistic is <span class="math inline">\(T = \text{ # of heads }\)</span>. That is, we just count how many of our 200 coin flips landed heads.</p>
<p><strong>Important point:</strong> we have assumed a <em>parametric model</em> for our data, so the test that we are about to develop is a <em>parametric test</em> of our null hypothesis. We are going to make specific use of our model assumption that the coinflips are distributed as independent Bernoullis, and use the fact that the total number of heads from those coinflips will be distributed as a Binomial random variable.</p>
<p>Under our model, <span class="math inline">\(T\)</span> is a sum of <span class="math inline">\(n=200\)</span> independent Bernoulli random variables, which means that <span class="math inline">\(T\)</span> is distributed according to a Binomial random variable with size parameter <span class="math inline">\(200\)</span> and success probability <span class="math inline">\(p\)</span>.</p>
<p>Let’s just assume (obviously incorrectly, but let’s do it for simplicity, just for the time being!) that larger <span class="math inline">\(T\)</span> corresponds to more “extreme” or “unusual” data. That is, small values of <span class="math inline">\(T\)</span> are <em>not</em> (for now!) considered evidence against the null hypothesis.</p>
<p>Following our discussion above, we need to find the value of <span class="math inline">\(t\)</span> that solves <span class="math display">\[
F_T( t ) = 1-\alpha,
\]</span></p>
<p>and reject if <span class="math inline">\(T \ge t\)</span>. Well, lucky for us, R already knows how to solve this! The <code>qRV</code> function in R, where <code>RV</code> is the name of a random variable, computes <em>quantiles</em> of a distribution. For <span class="math inline">\(q \in [0,1]\)</span>, the <span class="math inline">\(q\)</span>-th quantile of a distribution is the value <span class="math inline">\(t\)</span> such that <span class="math inline">\(F(t) = q\)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># size=200, prob=0.5 because those are the parameters of our model </span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">qbinom</span>(<span class="fl">0.95</span>, <span class="at">size=</span><span class="dv">200</span>, <span class="at">prob=</span><span class="fl">0.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 112</code></pre>
</div>
</div>
<p>Let’s just verify that this makes sense. We should have that <span class="math inline">\(F_T(112) = 1- \alpha = 0.95\)</span>. We can compute that in R using <code>pbinom</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pbinom</span>( <span class="dv">112</span>, <span class="at">size=</span><span class="dv">200</span>, <span class="at">prob=</span><span class="fl">0.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9615812</code></pre>
</div>
</div>
<p>Hmm… That’s not 0.95. What’s up with that?</p>
<p>Well, the binomial distribution is discrete, so there may not be an exact solution to <span class="math inline">\(F_T(t) = 1-\alpha\)</span>. Let’s try one click smaller:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pbinom</span>( <span class="dv">111</span>, <span class="at">size=</span><span class="dv">200</span>, <span class="at">prob=</span><span class="fl">0.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9481805</code></pre>
</div>
</div>
<p>Hmm… well, that’s a little smaller than we’d like ideally– we want this number to be exactly <span class="math inline">\(0.95 = 1-\alpha\)</span>, but it’s good enough! Let’s use a critical value of <span class="math inline">\(t=111\)</span> and reject if <span class="math inline">\(T &gt; 111\)</span>, while bearing in mind that our test is <em>technically speaking</em> only approximately level-<span class="math inline">\(\alpha\)</span> (but really the approximation is so close that it shouldn’t bother us…)</p>
<p><strong>Aside:</strong> there are ways to correct this issue that we just saw and make it so that we have exactly level-<span class="math inline">\(\alpha\)</span> probability of Type I error. Unfortunately, those tricks are a bit beyond the scope of our course this semester. Stay tuned in your later stats courses, or come ask at office hours!</p>
<p>Okay, so this says that if we want to test at level <span class="math inline">\(\alpha=0.05\)</span>, we should reject <span class="math inline">\(H_0\)</span> any time that we see <span class="math inline">\(T &gt; 111\)</span> heads.</p>
<p>Let’s try that a few times, and count how often we <em>incorrectly</em> reject the null hypothesis. If all goes well, we should reject close to <span class="math inline">\(0.05*100\)</span> = 1/20 = 5%$ of the time.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>run_coinflip_trial <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">pheads=</span><span class="fl">0.5</span>) {</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># run one iteration of our experiment.</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Return 0 if we accept the null hypothesis and return 1 if we reject</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Generate data under the null hypothesis.</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>  number_of_heads <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="at">n=</span><span class="dv">1</span>, <span class="at">size=</span><span class="dv">200</span>, <span class="at">prob=</span>pheads);</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># number_of_heads is already equal to our test statistic T.</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Just need to check whether or not it is above our rejection threshold.</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>( number_of_heads <span class="sc">&lt;=</span> <span class="dv">111</span>) {</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>( <span class="dv">0</span> ); <span class="co"># 0 like H_0, i.e., accept the null.</span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> { <span class="co"># test statistic is larger than rejection threshold}</span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>( <span class="dv">1</span> );</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now, let’s run the experiment a bunch of times.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>NMC <span class="ot">&lt;-</span> <span class="fl">1e4</span>; <span class="co"># Repeat our experiment 10K times.</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>nreject <span class="ot">&lt;-</span> <span class="dv">0</span>; <span class="co"># keep track of how often we reject</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>( i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>NMC ) {</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># conveniently, run_coinflip_trial returns 0 if we accept</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># and 1 if we reject, so to count how many rejections we get,</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># we can just sum them up.</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>  nreject <span class="ot">&lt;-</span> nreject <span class="sc">+</span> <span class="fu">run_coinflip_trial</span>()</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Now, compute our (empirical) probability of rejection</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>nreject<span class="sc">/</span>NMC</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.0532</code></pre>
</div>
</div>
<p>That number <em>should</em> be close to 0.05. Of course, there’s randomness in our experiment, so it will probably not be exact.</p>
<p>Now, let’s see what happens when the null isn’t true. Suppose that in truth, the coin is bent, and <span class="math inline">\(\Pr[\text{heads}] = 0.75\)</span>. How often do we (correctly) reject the null hypothesis?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>NMC <span class="ot">&lt;-</span> <span class="fl">1e4</span>; <span class="co"># Repeat our experiment 10K times.</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>nreject <span class="ot">&lt;-</span> <span class="dv">0</span>; <span class="co"># keep track of how often we reject</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>( i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>NMC ) {</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># conveniently, run_coinflip_trial returns 0 if we accept</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># and 1 if we reject, so to count how many rejections we get,</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># we can just sum them up.</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>  nreject <span class="ot">&lt;-</span> nreject <span class="sc">+</span> <span class="fu">run_coinflip_trial</span>(<span class="at">pheads=</span><span class="fl">0.75</span>);</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Now, compute our (empirical) probability of rejection</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>nreject<span class="sc">/</span>NMC</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1</code></pre>
</div>
</div>
<p>That number should be close to 1, if not equal to it. When the true value of <span class="math inline">\(p = \Pr[ \text{heads}]\)</span> is far from <span class="math inline">\(1/2\)</span>, our test manages to detect this fact and correctly reject the null hypothesis.</p>
<p>Okay, but how about a different way that our null hypothesis could be incorrect: suppose that <span class="math inline">\(p=0.25\)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>NMC <span class="ot">&lt;-</span> <span class="fl">1e4</span>; <span class="co"># Repeat our experiment 10K times.</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>nreject <span class="ot">&lt;-</span> <span class="dv">0</span>; <span class="co"># keep track of how often we reject</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>( i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>NMC ) {</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># conveniently, run_coinflip_trial returns 0 if we accept</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># and 1 if we reject, so to count how many rejections we get,</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># we can just sum them up.</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>  nreject <span class="ot">&lt;-</span> nreject <span class="sc">+</span> <span class="fu">run_coinflip_trial</span>(<span class="at">pheads=</span><span class="fl">0.25</span>);</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Now, compute our (empirical) probability of rejection</span></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>nreject<span class="sc">/</span>NMC</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0</code></pre>
</div>
</div>
<p>Hmm… that’s not great. Our test <em>never</em> rejects the null hypothesis, even though <span class="math inline">\(0.25=1/4\)</span> is pretty far from <span class="math inline">\(1/2\)</span>. We had no problem rejecting when <span class="math inline">\(p=0.75\)</span>, so what’s up?</p>
<p>Well, if we think a moment, this shouldn’t be so surprising. Our test rejects when the number of heads is larger than 111. If <span class="math inline">\(p = 0.25\)</span>, we expect that most of the time we’ll see about <span class="math inline">\(200 p = 50\)</span> heads, which is much smaller than 111. Thus, we should expect that our test will (almost) never reject the null hypothesis.</p>
</section>
<section id="one-sided-vs-two-sided-tests" class="level2" data-number="16.6">
<h2 data-number="16.6" class="anchored" data-anchor-id="one-sided-vs-two-sided-tests"><span class="header-section-number">16.6</span> One-sided vs two-sided tests</h2>
<p>This problem arises because our test above is what is a called a <em>one-sided test</em>. Our test statistic is good for detecting when the true value of <span class="math inline">\(p\)</span> is <em>larger</em> than <span class="math inline">\(1/2\)</span>, but ill-suited to detecting when the true value of <span class="math inline">\(p\)</span> is <em>smaller</em> than <span class="math inline">\(1/2\)</span>.</p>
<p>Remember how we said above that we were going to set aside the fact that an especially small number of heads could also be considered “weird”?</p>
<p>Let’s consider a <em>different</em> statistical test, still based on the number of heads <span class="math inline">\(T\)</span>, but this time we’ll devise a <em>two-sided</em> test, wherein we will reject if <span class="math inline">\(T\)</span> is too large <strong>or</strong> too small.</p>
<p>The trick is that now we need to be a bit more clever about our rejection thresholds. We want to devise a statistical test wherein we reject if <span class="math inline">\(T\)</span> is smaller than some number, say <span class="math inline">\(t_1\)</span>, or larger than some other number <span class="math inline">\(t_2 &gt; t_1\)</span>. The trick is, we still want to make sure that we have significance level <span class="math inline">\(\alpha\)</span>. That is, we want it to be the case that <span class="math display">\[
\Pr[ \text{reject}; H_0 ] = \Pr[ \{T &lt; t_{\alpha,1} \} \cup \{T &gt; t_{\alpha,2} \} ] = \alpha
\]</span></p>
<p>There are a lot of ways we can do this, but the easiest (and most pleasingly symmetric) is to choose <span class="math inline">\(t_{\alpha,1}\)</span> and <span class="math inline">\(t_{\alpha,2}\)</span> so that <span class="math inline">\(\Pr[ T &lt; t_{\alpha,1} ] = \alpha/2\)</span> and <span class="math inline">\(\Pr[ T &gt; t_{\alpha,2} ] = \alpha/2\)</span>. Then, since the events <span class="math inline">\(\{ T&lt;t_{\alpha,1} \}\)</span> and <span class="math inline">\(\{ T &gt; t_{\alpha,2} \}\)</span> are disjoint, <span class="math display">\[
\Pr[ \{T &lt; t_{\alpha,1} \} \cup \{T &gt; t_{\alpha,2} \} ]
= \Pr[ T &lt; t_{\alpha,1} ] + \Pr[ T &gt; t_{\alpha,2} ] = \frac{\alpha}{2} + \frac{\alpha}{2} = \alpha.
\]</span></p>
<p>The set <span class="math display">\[
\{ x : x &lt; t_{\alpha,1} \text{ or } x &gt; t_{\alpha,2} \}
\]</span></p>
<p>Is called a <em>rejection region</em>, because it is the set of values for which we reject the null hypothesis.</p>
<p><strong>Note:</strong> different books and articles will follow different conventions around whether the region should have <span class="math inline">\(x \le t_{\alpha,1}\)</span> or <span class="math inline">\(x &lt; t_{\alpha,1}\)</span>, and similarly for the upper limit. Just something to be careful of. Which convention we use doesn’t really matter– the important thing is that we are 1) consistent and 2) we make sure that we choose the rejection threshold so that our probability of rejecting under the null is <span class="math inline">\(\alpha\)</span>.</p>
<p>Here’s a picture of the situation:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Draw the PMF of the Binomial</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">200</span>, <span class="fu">dbinom</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">200</span>, <span class="at">p=</span><span class="fl">0.5</span>, <span class="at">size=</span><span class="dv">200</span>) )</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Draw a line indicating a lower rejection threshold at 87</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="co"># (we'll see below how we choose 86! For now, it's just for the sake of</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="co"># choosing some lower limit to draw the picture!)</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span><span class="dv">87</span>, <span class="at">col=</span><span class="st">'red'</span>)</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a><span class="co"># and similarly draw a line for the right-hand rejection threshold.</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a><span class="co"># again, how we choose </span></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span><span class="dv">114</span>, <span class="at">col=</span><span class="st">'red'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="testing2_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The dots indicate the distribution of our test statistic (i.e., the number of heads). Our test is going to reject the null hypothesis if the statistic <span class="math inline">\(T\)</span> falls <em>outside</em> the two red lines.</p>
<p>The dots in the plot trace out the PMF of the Binomial, so the “area under the curve” is 1.</p>
<p><strong>Bonus question:</strong> why did I put “area under the curve” in quotes, there?</p>
<p>To keep our test at level-<span class="math inline">\(\alpha\)</span> (i.e., to ensure that our probability of a Type I error is <span class="math inline">\(\alpha\)</span>, or, equivalently, that we incorrectly reject under the null with probability <span class="math inline">\(\alpha\)</span>), we need to choose these two lines so that the area under the curve <em>outside</em> the two lines is equal to <span class="math inline">\(\alpha\)</span>.</p>
<p>Equivalently, we need to choose the two red lines so that the area under the curve <em>between</em> the two lines is equal to <span class="math inline">\(1-\alpha\)</span>.</p>
<section id="choosing-the-rejection-region" class="level3" data-number="16.6.1">
<h3 data-number="16.6.1" class="anchored" data-anchor-id="choosing-the-rejection-region"><span class="header-section-number">16.6.1</span> Choosing the rejection region</h3>
<p>So how do we actually figure out <span class="math inline">\(t_{\alpha,1}\)</span> and <span class="math inline">\(t_{\alpha,2}\)</span>?</p>
<p>Well, we still know the distribution of <span class="math inline">\(T\)</span> under the null distribution– it is a Binomial with size parameter <span class="math inline">\(200\)</span> and success probability <span class="math inline">\(p\)</span>.</p>
<p>So, just as with <span class="math inline">\(t_\alpha\)</span> above, we can use <code>qbinom</code> to find <span class="math inline">\(t_{\alpha,1}\)</span> solving <span class="math display">\[
F_T( t_{\alpha,1} ) = \alpha/2.
\]</span></p>
<p>Okay, so let’s do that.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Reminder: we need the quantile of \alpha/2 = 0.025.</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">qbinom</span>(<span class="fl">0.025</span>, <span class="at">size=</span><span class="dv">200</span>, <span class="at">prob=</span><span class="fl">0.5</span>);</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 86</code></pre>
</div>
</div>
<p>And let’s just check that with <code>pbinom</code>. We want this to evaluate to (close to) <span class="math inline">\(0.025\)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pbinom</span>(<span class="dv">86</span>, <span class="at">size=</span><span class="dv">200</span>, <span class="at">prob=</span><span class="fl">0.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.02798287</code></pre>
</div>
</div>
<p>Hmm… that is a touch high… Let’s try one click smaller, again, just to make sure that the discrete nature of our data isn’t playing tricks on us.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pbinom</span>(<span class="dv">85</span>, <span class="at">size=</span><span class="dv">200</span>, <span class="at">prob=</span><span class="fl">0.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.0200186</code></pre>
</div>
</div>
<p>Okay, that’s way smaller, so let’s stick with rejecting when <span class="math inline">\(T \le 86\)</span>, i.e., <span class="math inline">\(T&lt;87\)</span>. So <span class="math inline">\(t_{\alpha,1} = 87\)</span>.</p>
<p>What about <span class="math inline">\(t_{\alpha,2}\)</span>? We need to choose it so that <span class="math inline">\(\Pr[ T &gt; t_{\alpha,2}; H_0 ] = 0.025 = \alpha/2.\)</span> Well, <span class="math display">\[
\Pr[ T &gt; t_{\alpha,2}; H_0 ] = 1- \Pr[ T \le t_{\alpha,2}; H_0 ].
\]</span></p>
<p>So we just need to find <span class="math inline">\(t_{\alpha,2}\)</span> satisfying <span class="math display">\[
\Pr[ T \le t_{\alpha,2}; H_0 ] = 1-\alpha/2 = 1-0.025 = 0.975.
\]</span></p>
<p>Once again, now that we have an event of the form <span class="math inline">\(T \le t_{\alpha,2}\)</span>, we have a plain old cumulative distribution function, and we can use R to solve this.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qbinom</span>(<span class="fl">0.975</span>, <span class="at">size=</span><span class="dv">200</span>, <span class="at">prob=</span><span class="fl">0.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 114</code></pre>
</div>
</div>
<p>And let’s just verify that this is reasonably close to what we want, in light of the discrete nature of our data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pbinom</span>(<span class="dv">114</span>, <span class="at">size=</span><span class="dv">200</span>, <span class="at">prob=</span><span class="fl">0.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9799814</code></pre>
</div>
</div>
<p>Hmm… just to double check, let’s try choosing that threshold a bit lower.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pbinom</span>(<span class="dv">113</span>, <span class="at">size=</span><span class="dv">200</span>, <span class="at">prob=</span><span class="fl">0.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9720171</code></pre>
</div>
</div>
<p>Okay, neither of these is great– we want exactly <span class="math inline">\(0.975\)</span>, remember. Let’s stick with <span class="math inline">\(114\)</span>.</p>
<p>So we are going to use <span class="math inline">\(t_{1,\alpha} = 87\)</span> and <span class="math inline">\(t_{2,\alpha} = 114\)</span> as demarcating our rejection region.</p>
<p>Let’s implement our two-sided hypothesis test.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>run_coinflip_trial2 <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">pheads=</span><span class="fl">0.5</span>) {</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># run one iteration of our experiment for our two-sided test.</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Return 0 if we accept the null hypothesis and return 1 if we reject</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Generate data under the null hypothesis.</span></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>  number_of_heads <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="at">n=</span><span class="dv">1</span>, <span class="at">size=</span><span class="dv">200</span>, <span class="at">prob=</span>pheads);</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># number_of_heads is already equal to our test statistic T.</span></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Just need to check whether or not it is in the rejection region</span></span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>( number_of_heads <span class="sc">&lt;</span> <span class="dv">87</span> <span class="sc">|</span> number_of_heads <span class="sc">&gt;</span> <span class="dv">114</span> ) {</span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="dv">1</span>); <span class="co"># Reject the null hypothesis.</span></span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="dv">0</span>); <span class="co"># Accept H_0, hence returning 0.</span></span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>And once again, let’s try running our experiment a large number of times, under the setting where the null hypothesis <span class="math inline">\(p=1/2\)</span> is in fact true, and track how often we incorrectly reject. It should be about <span class="math inline">\(\alpha=0.05\)</span>, once again.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>NMC <span class="ot">&lt;-</span> <span class="fl">1e4</span>; <span class="co"># Repeat our experiment 10K times.</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>nreject <span class="ot">&lt;-</span> <span class="dv">0</span>; <span class="co"># keep track of how often we reject</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>( i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>NMC ) {</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># conveniently, run_coinflip_trial returns 0 if we accept</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># and 1 if we reject, so to count how many rejections we get,</span></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># we can just sum them up.</span></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>  nreject <span class="ot">&lt;-</span> nreject <span class="sc">+</span> <span class="fu">run_coinflip_trial2</span>(<span class="at">pheads=</span><span class="fl">0.5</span>);</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Now, compute our (empirical) probability of rejection</span></span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>nreject<span class="sc">/</span>NMC</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.0491</code></pre>
</div>
</div>
<p>Once again, this should be close to <span class="math inline">\(0.05\)</span>, though again not exact, since our experiments are random.</p>
</section>
</section>
<section id="one-sided-vs-two-sided-tests-1" class="level2" data-number="16.7">
<h2 data-number="16.7" class="anchored" data-anchor-id="one-sided-vs-two-sided-tests-1"><span class="header-section-number">16.7</span> One-sided vs two-sided tests</h2>
<p>So, at this point, we’ve seen two different tests of our null hypothesis, <span class="math display">\[
H_0 : p = \frac{1}{2}.
\]</span></p>
<p>Both have the same level <span class="math inline">\(\alpha = 0.05\)</span> (at least approximately, but let’s ignore that!), but they have different rejection regions.</p>
<p>Our first test was one-sided, and we only rejected for large values of <span class="math inline">\(T = \text{number of heads}\)</span>.</p>
<p>Our second test was two-sided, and rejected for small <em>or</em> large values of <span class="math inline">\(T\)</span>.</p>
<p>Notice, however, that the “large” threshold for these two different tests are different. Compare</p>
<p><span class="math display">\[
\{ t : t &gt;114 \} ~ \text{ versus } ~ \{  t : t &gt; 111 \}.
\]</span></p>
<p>Our two-sided test, which rejects values of <span class="math inline">\(T\)</span> bigger than 114, requires “more extreme” values on the large side to reject the null hypothesis when compared with our one-sided test. This means that there <em>should</em> be values of <span class="math inline">\(p\)</span> for which our one-sided test rejects reasonably frequently while our two-sided test is less likely to reject. Let’s see if we can find such a value.</p>
<p>First, let’s write code to compare our two different tests.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>compare_reject_rates <span class="ot">&lt;-</span> <span class="cf">function</span>( p ) {</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Run 10K experiments under the setting where P[heads]=p.</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Use both the one-sided and two-sided tests and track how often</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># each one rejects.</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>  NMC <span class="ot">&lt;-</span> <span class="fl">1e4</span>; <span class="co"># Repeat our experiment 10K times.</span></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># keep track of how often our two different tests reject.</span></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>  nreject_twosided <span class="ot">&lt;-</span> <span class="dv">0</span>;</span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>  nreject_onesided <span class="ot">&lt;-</span> <span class="dv">0</span>;</span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>( i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>NMC ) {</span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># conveniently, run_coinflip_trial returns 0 if we accept</span></span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a>    <span class="co"># and 1 if we reject, so to count how many rejections we get,</span></span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a>    <span class="co"># we can just sum them up.</span></span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a>    nreject_onesided <span class="ot">&lt;-</span> nreject_onesided <span class="sc">+</span> <span class="fu">run_coinflip_trial</span>(<span class="at">pheads=</span>p)</span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a>    nreject_twosided <span class="ot">&lt;-</span> nreject_twosided <span class="sc">+</span> <span class="fu">run_coinflip_trial2</span>(<span class="at">pheads=</span>p);</span>
<span id="cb30-18"><a href="#cb30-18" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb30-19"><a href="#cb30-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>( <span class="fu">c</span>( nreject_onesided<span class="sc">/</span>NMC, nreject_twosided<span class="sc">/</span>NMC ) );</span>
<span id="cb30-20"><a href="#cb30-20" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now, let’s try some values of <span class="math inline">\(p\)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>pseq <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fl">0.5</span>, <span class="dv">1</span>, <span class="fl">0.01</span>);</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Reminder: the mapply function takes a function and a vector of values</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a><span class="co"># and applies that function to each of those values.</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a><span class="co"># See ?mapply for details.</span></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a><span class="co"># You've probably seen functions from the tidyverse (e.g., dplyr)</span></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a><span class="co"># for doing similar things. I'm showing you mapply to stress that there are</span></span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a><span class="co"># lots of different ways for doing the (more or less) same thing in R.</span></span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>rej_rates <span class="ot">&lt;-</span> <span class="fu">mapply</span>( compare_reject_rates, pseq )</span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Take a careful look at how the output is shaped:</span></span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>rej_rates</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       [,1]   [,2]   [,3]   [,4]   [,5]   [,6]   [,7]   [,8]   [,9]  [,10]
[1,] 0.0497 0.0883 0.1426 0.2188 0.3054 0.4183 0.5350 0.6459 0.7417 0.8257
[2,] 0.0514 0.0545 0.0748 0.1208 0.1848 0.2609 0.3611 0.4719 0.5844 0.6888
      [,11]  [,12]  [,13]  [,14]  [,15]  [,16]  [,17]  [,18]  [,19] [,20] [,21]
[1,] 0.8929 0.9330 0.9668 0.9818 0.9916 0.9965 0.9983 0.9995 0.9999     1     1
[2,] 0.7885 0.8595 0.9177 0.9510 0.9743 0.9888 0.9941 0.9980 0.9986     1     1
     [,22] [,23] [,24] [,25] [,26] [,27] [,28] [,29] [,30] [,31] [,32] [,33]
[1,]     1     1     1     1     1     1     1     1     1     1     1     1
[2,]     1     1     1     1     1     1     1     1     1     1     1     1
     [,34] [,35] [,36] [,37] [,38] [,39] [,40] [,41] [,42] [,43] [,44] [,45]
[1,]     1     1     1     1     1     1     1     1     1     1     1     1
[2,]     1     1     1     1     1     1     1     1     1     1     1     1
     [,46] [,47] [,48] [,49] [,50] [,51]
[1,]     1     1     1     1     1     1
[2,]     1     1     1     1     1     1</code></pre>
</div>
</div>
<p>Let’s make a plot of the two different rejection rates as a function of <span class="math inline">\(p\)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>onesided <span class="ot">&lt;-</span> rej_rates[<span class="dv">1</span>,]</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>twosided <span class="ot">&lt;-</span> rej_rates[<span class="dv">2</span>,]</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a><span class="co"># We're going to make a plot in ggplot2 because it's prettier.</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a><span class="co"># ggplot2 wants a dataframe, so we have to build it.</span></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a><span class="co"># We'll make a column of our probabilities,</span></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a><span class="co"># a column of our rejections rates,</span></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a><span class="co"># and a column labeling one- vs two-sided.</span></span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a><span class="co"># We needtwo copies of the pseq sequence, one for each of our tests,</span></span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a><span class="co"># hence the p=rep(pseq,2)</span></span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>rejrate <span class="ot">&lt;-</span> <span class="fu">c</span>(onesided,twosided);</span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>sidedness <span class="ot">&lt;-</span> <span class="fu">c</span>( <span class="fu">rep</span>(<span class="st">'One-sided'</span>,<span class="fu">length</span>(onesided)),</span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a>                <span class="fu">rep</span>(<span class="st">'Two-sided'</span>,<span class="fu">length</span>(twosided) ) );</span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>( <span class="at">p=</span><span class="fu">rep</span>(pseq,<span class="dv">2</span>), <span class="at">RejectionRate=</span>rejrate, <span class="at">Test=</span>sidedness );</span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb33-16"><a href="#cb33-16" aria-hidden="true" tabindex="-1"></a>pp <span class="ot">&lt;-</span> <span class="fu">ggplot</span>( df, <span class="fu">aes</span>(<span class="at">x=</span>p, <span class="at">y=</span>RejectionRate, <span class="at">color=</span>Test) );</span>
<span id="cb33-17"><a href="#cb33-17" aria-hidden="true" tabindex="-1"></a>pp <span class="ot">&lt;-</span> pp <span class="sc">+</span> <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">color=</span>Test)) <span class="sc">+</span> <span class="fu">geom_hline</span>(<span class="at">yintercept=</span><span class="fl">0.05</span>, <span class="at">color=</span><span class="st">'red'</span>);</span>
<span id="cb33-18"><a href="#cb33-18" aria-hidden="true" tabindex="-1"></a>pp</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="testing2_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>So we see that the one-sided test is more likely to (correctly) reject compared to the two-sided test when <span class="math inline">\(p &gt; 1/2\)</span>.</p>
<p>But this plot doesn’t tell the whole story– let’s look at the whole range of <span class="math inline">\(p \in [0,1]\)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>pseq <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.01</span>);</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>rej_rates <span class="ot">&lt;-</span> <span class="fu">mapply</span>( compare_reject_rates, pseq )</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>onesided <span class="ot">&lt;-</span> rej_rates[<span class="dv">1</span>,]</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>twosided <span class="ot">&lt;-</span> rej_rates[<span class="dv">2</span>,]</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a><span class="co"># We're going to make a plot in ggplot2 because it's prettier.</span></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a><span class="co"># ggplot2 wants a dataframe, so we have to build it.</span></span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a><span class="co"># We'll make a column of our probabilities,</span></span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a><span class="co"># a column of our rejections rates,</span></span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a><span class="co"># and a column labeling one- vs two-sided.</span></span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a><span class="co"># We need two copies of the pseq sequence, one for each of our tests,</span></span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a><span class="co"># hence the p=rep(pseq,2)</span></span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a>rejrate <span class="ot">&lt;-</span> <span class="fu">c</span>(onesided,twosided);</span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a>sidedness <span class="ot">&lt;-</span> <span class="fu">c</span>( <span class="fu">rep</span>(<span class="st">'One-sided'</span>,<span class="fu">length</span>(onesided)),</span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a>                <span class="fu">rep</span>(<span class="st">'Two-sided'</span>,<span class="fu">length</span>(twosided) ) );</span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>( <span class="at">p=</span><span class="fu">rep</span>(pseq,<span class="dv">2</span>), <span class="at">RejectionRate=</span>rejrate, <span class="at">Test=</span>sidedness );</span>
<span id="cb34-18"><a href="#cb34-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-19"><a href="#cb34-19" aria-hidden="true" tabindex="-1"></a>pp <span class="ot">&lt;-</span> <span class="fu">ggplot</span>( df, <span class="fu">aes</span>(<span class="at">x=</span>p, <span class="at">y=</span>RejectionRate, <span class="at">color=</span>Test) );</span>
<span id="cb34-20"><a href="#cb34-20" aria-hidden="true" tabindex="-1"></a>pp <span class="ot">&lt;-</span> pp <span class="sc">+</span> <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">color=</span>Test)) <span class="sc">+</span> <span class="fu">geom_hline</span>(<span class="at">yintercept=</span><span class="fl">0.05</span>, <span class="at">color=</span><span class="st">'red'</span>);</span>
<span id="cb34-21"><a href="#cb34-21" aria-hidden="true" tabindex="-1"></a>pp</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="testing2_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><strong>An important point:</strong> both of these test have the <em>same</em> level. That is, their probability of rejecting the null when <span class="math inline">\(H_0\)</span> is true (i.e., <span class="math inline">\(p=1/2\)</span>) is the same (up to the approximations that we had to make in dealing with the fact that the Binomial is a discrete distribution):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">compare_reject_rates</span>(<span class="fl">0.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.0527 0.0428</code></pre>
</div>
</div>
</section>
<section id="test-statistics-and-where-to-find-them" class="level2" data-number="16.8">
<h2 data-number="16.8" class="anchored" data-anchor-id="test-statistics-and-where-to-find-them"><span class="header-section-number">16.8</span> Test statistics and where to find them</h2>
<p>Crucial to our discussion above was that we have our function that measured how “unusual” or “extreme” our data is. This function is called a <em>test statistic</em> because it is a function of the data (hence a “statistic”) and because we use it in the test of our hypothesis.</p>
<p>Sometimes it’s really obvious what our test statistic should be– like counting how many cups our tea taster got right. Sometimes it’s less obvious. We’ll see examples like that later in the semester.</p>
<p>Let’s look at this in the context of our coinflipping example above. We’ll why the “right” test statistic isn’t always obvious.</p>
</section>
<section id="example-flipping-a-possibly-biased-coin-continued" class="level2" data-number="16.9">
<h2 data-number="16.9" class="anchored" data-anchor-id="example-flipping-a-possibly-biased-coin-continued"><span class="header-section-number">16.9</span> Example: flipping a (possibly biased) coin, continued</h2>
<p>Reminder: our null hypothesis was that the coin is fair, which we would write as <span class="math display">\[
H_0 : p = \frac{1}{2}.
\]</span></p>
<p>Here is the result of flipping this coin 200 times:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>flips <span class="ot">&lt;-</span> <span class="st">"HTTHTHHTTHTTTHTHHTTHHTHHTHHHHHTTTTHHHHHHHHTHHTHHHTTTHTTTHHHTHHHHHHTHTTHTTHTHTTHHHHTHHHTHHTTHTTTTTTHHHTTHTHTHHTTHHHTTTHHTHHHTTHHTTTTTHTHHTTTHTTHTTHHTTTTTHTTTHTHHHHTTTTTHTTTHHHHHTHHTHTHHTTTTTTHHHTTTHTTT"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>How might we go about testing our null hypothesis that <span class="math inline">\(p=1/2\)</span>? Well, we have to start by asking what we expect the data to “look like” if the probability of heads is actually <span class="math inline">\(1/2\)</span>, and then come up with a test statistic that captures that.</p>
<p>Above, we chose the number of heads as our test statistic, which is certainly a reasonable choice, but let’s pause to appreciate that there are other test statistics we could have chosen.</p>
<p>Let’s implement that test statistic, this time in a way that it takes a string of coinflips like our data above.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>count_heads <span class="ot">&lt;-</span> <span class="cf">function</span>( coinflips ) {</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># We're implicitly assuming coinflips is a vector of one-character strings.</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Just a reminder that in non-demo code, we usually want to include some</span></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># error checking to make sure that our function's arguments are</span></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># as we expect.</span></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>( <span class="fu">sum</span>( coinflips<span class="sc">==</span><span class="fu">rep</span>(<span class="st">'H'</span>, <span class="fu">length</span>(coinflips)) ) );</span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Okay, let’s apply this statistic to our <code>flips</code> data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># We need to turn our string of coin flips into a vector before</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="co"># we pass it into `count_heads()`</span></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a><span class="co"># strsplit( x, split=s) splits the string x on the separating character s,</span></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a><span class="co"># and returns a list structure. See ?strsplit for more.</span></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a><span class="co"># unlist( v ) turns a list structure into a flat vector that is easier</span></span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a><span class="co"># to work with. See ?unlist for details.</span></span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a><span class="fu">count_heads</span>( <span class="fu">unlist</span>( <span class="fu">strsplit</span>( flips, <span class="at">split=</span><span class="st">''</span> ) ) );</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 99</code></pre>
</div>
</div>
<p>Okay, now, we’ve chosen our test statistic, which measures how “unusual” or “extreme” our data is. But we don’t know how unusual is unusual, or how extreme is extreme. That is, we don’t know what this number <em>would</em> look like, if the null hypothesis were true.</p>
<p>Let’s simulate some data under the null hypothesis to get an idea.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>simulate_coinflips <span class="ot">&lt;-</span> <span class="cf">function</span>(n, p) {</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>  flips <span class="ot">&lt;-</span> <span class="fu">sample</span>( <span class="fu">c</span>(<span class="st">'H'</span>,<span class="st">'T'</span>), <span class="at">size=</span>n, <span class="at">replace=</span><span class="cn">TRUE</span>, <span class="at">prob=</span><span class="fu">c</span>(p, <span class="dv">1</span><span class="sc">-</span>p) );</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># flips is now a vector of 'H' and 'T's,</span></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># which is what count_heads expects, so let's return it.</span></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># If we were going to print this or something, I might prefer to</span></span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># return a string using paste( flips, sep='')</span></span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>( flips );</span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Now let's simulate a bunch of coinflips</span></span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a>NMC <span class="ot">&lt;-</span> <span class="dv">500</span>;</span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a><span class="co"># We're going to make a histogram of the number of heads that show up</span></span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a><span class="co"># in each experiment run, so create a vector to store those in.</span></span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true" tabindex="-1"></a>counts <span class="ot">&lt;-</span> <span class="fu">rep</span>( <span class="dv">0</span>, NMC );</span>
<span id="cb41-15"><a href="#cb41-15" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>( i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>NMC ) {</span>
<span id="cb41-16"><a href="#cb41-16" aria-hidden="true" tabindex="-1"></a>  counts[i] <span class="ot">&lt;-</span> <span class="fu">count_heads</span>( <span class="fu">simulate_coinflips</span>( <span class="dv">200</span>, <span class="fl">0.5</span> ) );</span>
<span id="cb41-17"><a href="#cb41-17" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb41-18"><a href="#cb41-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-19"><a href="#cb41-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Now, make a histogram. As usual, we could use ggplot2 to make things</span></span>
<span id="cb41-20"><a href="#cb41-20" aria-hidden="true" tabindex="-1"></a><span class="co"># look a bit nicer, but we just want something quick and simple, here.</span></span>
<span id="cb41-21"><a href="#cb41-21" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>( counts ) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="testing2_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The vast majority of the time, the number of heads in 200 fair coin flips is between 80 and 120. Once in a while, of course, it’s more than that or less than that, but an “unusual” result would presumably correspond to a number of heads being much larger <em>or</em> much smaller than <span class="math inline">\(100\)</span>. This corresponds to our <em>two-sided test</em> discussed above– we are concerned about the true value of <span class="math inline">\(p\)</span> being <em>either</em> higher or lower than our null value <span class="math inline">\(p = 1/2\)</span>.</p>
<p>For now, let’s just note that our data observed in <code>flips</code>, has a number of coin flips well within our “usual” range of 80 to 120.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">count_heads</span>( <span class="fu">unlist</span>( <span class="fu">strsplit</span>(flips, <span class="at">split=</span><span class="st">''</span>)) )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 99</code></pre>
</div>
</div>
<p>Now, here’s a different sequence of coin flips:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>more_flips <span class="ot">&lt;-</span> <span class="st">'HHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTT'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This sequence of flips has 100 heads and 100 tails:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">count_heads</span>( <span class="fu">unlist</span>( <span class="fu">strsplit</span>( more_flips, <span class="at">split=</span><span class="st">''</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 100</code></pre>
</div>
</div>
<p>According to our test statistic, this is not an unusual outcome at all– in 200 flips of a fair coin, we expect there to be around 100 heads and 100 tails. Yet I think we can all agree that there’s something unusual about the sequence of coin flips above.</p>
<p>If you’ve seen the play <em>Rosencrantz and Guildenstern Are Dead</em> (or watched the movie based on the play), this might ring a bell. For those not familiar, see <a href="https://www.youtube.com/watch?v=C_TfdNAXOwE">this clip</a>.</p>
<p>So here we see that our test statistic doesn’t capture all of the ways that our data could be “extreme” or “unusual”. This is precisely why devising a “good” test statistic can be hard!</p>
<p>One example of a good statistic here may be to examine run lengths, e.g.&nbsp;using a function like this.</p>
<pre><code>longestRun = function(x,target){
    max(0,with(rle(x), lengths[values==target]))
}</code></pre>
<p>There are a lot of different ways that our data can be “weird”, and we need to be careful that we capture the right notion of weirdness!</p>
</section>
<section id="choosing-alpha-trade-offs" class="level2" data-number="16.10">
<h2 data-number="16.10" class="anchored" data-anchor-id="choosing-alpha-trade-offs"><span class="header-section-number">16.10</span> Choosing <span class="math inline">\(\alpha\)</span>: trade-offs</h2>
<p>The standard choice in (most of) the sciences is to set <span class="math inline">\(\alpha=0.05\)</span>. You probably already remember this number from STAT240 or other courses.</p>
<p>This really is a pretty arbitrary choice, based largely on some writings by early statistics researchers, but for some reason it has stuck. You’ll sometimes see researchers use <span class="math inline">\(\alpha=0.01\)</span>, also, but the “right” choice of <span class="math inline">\(\alpha\)</span> really depends on the nature of the research problem you are asking and on how “bad” it would be to commit a false positive.</p>
<p><strong>Example:</strong> consider a screening test for cancer, where the null hypothesis corresponds to the patient being healthy (i.e., not having cancer). Then a Type I error corresponds to mistakenly declaring that a test subject has cancer when they in fact do not. Of course, this isn’t ideal– this false positive may cause the patient to worry and would trigger expensive follow-up tests to confirm a cancer diagnosis.</p>
<p>On the other hand, compare this risk against the risk of committing a Type II error. This would correspond to a patient who comes to us with cancer, but our test does not detect the cancer. Our patient goes home, mistakenly thinking they do not have cancer. This is certainly a much worse outcome than a Type I error, and we may want to spend more resources guarding against this, <em>even if</em> it means a higher chance of committing a Type I error.</p>
<p>Generally speaking, reducing <span class="math inline">\(\alpha\)</span> (i.e., reducing the probability of a Type I error) incurs an increase in the probability of a Type II error, and vice versa. The details of this trade-off will have to wait for your later classes, but it’s good to be aware of it!</p>
</section>
<section id="review" class="level2" data-number="16.11">
<h2 data-number="16.11" class="anchored" data-anchor-id="review"><span class="header-section-number">16.11</span> Review</h2>
<p>In this lecture we covered:</p>
<ul>
<li>Type 1 and Type 2 Errors</li>
<li>Balance between error types</li>
<li>Significance Level <span class="math inline">\(\alpha\)</span></li>
<li>Rejection rules (critical value)</li>
<li>One-sided vs two-sided tests</li>
<li>Rejection region</li>
<li>Power of a test statistic</li>
<li>Power function (curve)</li>
<li>Comparing test statistics</li>
<li>Choosing <span class="math inline">\(\alpha\)</span></li>
</ul>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
  </div>
  <div class="nav-page nav-page-next">
      <a href="./R05_testing_Additional_Examples.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Monte Carlo Testing: Additional Examples</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>