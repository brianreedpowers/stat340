<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.353">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>STAT 340: Data Science II - 13&nbsp; Introduction to Statistical Testing</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./R04_Monte_Carlo_Testing.html" rel="next">
<link href="./R_MonteCarlo_Battleship.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./testing1.html">Testing</a></li><li class="breadcrumb-item"><a href="./testing1.html"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Introduction to Statistical Testing</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">STAT 340: Data Science II</a> 
        <div class="sidebar-tools-main">
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">STAT 340 Index</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="false">
 <span class="menu-text">Sampling</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rv.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Random Variables</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./R01_RandomVariables.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Random Variables R Examples</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rv_practice.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Probability and Random Variables Practice</span></span></a>
  </div>
</li>
          <li class="px-0"><hr class="sidebar-divider hi "></li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./cov.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Independence, Conditional Probability and Bayes’ Rule</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./R02_IndepCondBayes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Independence, Conditional Probability and Bayes Theorem R Examples</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./cov_practice.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Independence and Conditional Probability Practice</span></span></a>
  </div>
</li>
          <li class="px-0"><hr class="sidebar-divider hi "></li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./mc.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Monte Carlo</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./R03_MonteCarloExamples.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Monte Carlo Examples</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./mc_practice.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Monte Carlo Practice</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./R_MonteCarlo_Battleship.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Monte Carlo Battleship</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">Testing</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./testing1.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Introduction to Statistical Testing</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./R04_Monte_Carlo_Testing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Monte Carlo Testing</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./testing1_practice.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Monte Carlo Testing Practice</span></span></a>
  </div>
</li>
          <li class="px-0"><hr class="sidebar-divider hi "></li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./testing2_practice.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Testing and Power Practice</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="false">
 <span class="menu-text">Estimation</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./estimation1_practice.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Point Estimation Practice</span></span></a>
  </div>
</li>
          <li class="px-0"><hr class="sidebar-divider hi "></li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./estimation2_practice.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Interval Estimation Practice</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="false">
 <span class="menu-text">Prediction</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./slr_practice.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Simple Linear Regression Practice</span></span></a>
  </div>
</li>
          <li class="px-0"><hr class="sidebar-divider hi "></li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./mlr_practice.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Multiple Linear Regression Practice</span></span></a>
  </div>
</li>
          <li class="px-0"><hr class="sidebar-divider hi "></li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./logistic_practice.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Logistic Regression Practice</span></span></a>
  </div>
</li>
          <li class="px-0"><hr class="sidebar-divider hi "></li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./cv_practice.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Cross Validation Practice</span></span></a>
  </div>
</li>
          <li class="px-0"><hr class="sidebar-divider hi "></li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./bootstrap_practice.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Bootstrap Practice</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="false">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./RV_summary.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Random Variable Summary</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#learning-objectives" id="toc-learning-objectives" class="nav-link active" data-scroll-target="#learning-objectives"><span class="header-section-number">13.1</span> Learning objectives</a></li>
  <li><a href="#motivating-example-the-lady-tasting-tea" id="toc-motivating-example-the-lady-tasting-tea" class="nav-link" data-scroll-target="#motivating-example-the-lady-tasting-tea"><span class="header-section-number">13.2</span> Motivating example: the lady tasting tea</a></li>
  <li><a href="#better-than-chance" id="toc-better-than-chance" class="nav-link" data-scroll-target="#better-than-chance"><span class="header-section-number">13.3</span> Better than chance?</a></li>
  <li><a href="#wait-that-was-hypothesis-testing" id="toc-wait-that-was-hypothesis-testing" class="nav-link" data-scroll-target="#wait-that-was-hypothesis-testing"><span class="header-section-number">13.4</span> Wait, that was hypothesis testing!</a></li>
  <li><a href="#formalizing-slowly" id="toc-formalizing-slowly" class="nav-link" data-scroll-target="#formalizing-slowly"><span class="header-section-number">13.5</span> Formalizing (slowly)</a></li>
  <li><a href="#another-example-vaccine-efficacy" id="toc-another-example-vaccine-efficacy" class="nav-link" data-scroll-target="#another-example-vaccine-efficacy"><span class="header-section-number">13.6</span> Another example: vaccine efficacy</a></li>
  <li><a href="#formalizing-for-real-this-time" id="toc-formalizing-for-real-this-time" class="nav-link" data-scroll-target="#formalizing-for-real-this-time"><span class="header-section-number">13.7</span> Formalizing (for real, this time)</a></li>
  <li><a href="#introducing-p-values" id="toc-introducing-p-values" class="nav-link" data-scroll-target="#introducing-p-values"><span class="header-section-number">13.8</span> Introducing p-values</a></li>
  <li><a href="#example-drug-trials" id="toc-example-drug-trials" class="nav-link" data-scroll-target="#example-drug-trials"><span class="header-section-number">13.9</span> Example: drug trials</a>
  <ul class="collapse">
  <li><a href="#reminder-parametric-testing" id="toc-reminder-parametric-testing" class="nav-link" data-scroll-target="#reminder-parametric-testing"><span class="header-section-number">13.9.1</span> Reminder: parametric testing</a></li>
  </ul></li>
  <li><a href="#permutation-tests" id="toc-permutation-tests" class="nav-link" data-scroll-target="#permutation-tests"><span class="header-section-number">13.10</span> Permutation tests</a>
  <ul class="collapse">
  <li><a href="#review" id="toc-review" class="nav-link" data-scroll-target="#review"><span class="header-section-number">13.10.1</span> Review:</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Introduction to Statistical Testing</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p>For the next two weeks, we’ll be talking about statistical hypothesis testing. Hypothesis testing is one of the core tasks that we perform as statisticians and data scientists. Most of the time, hypothesis testing is used to answer questions concerning whether or not there is a difference between two groups (e.g., patients given a treatment and patients given a placebo). We’re going to start this week with very simple questions and settings, where it’s easy to understand all the moving parts and build intuition. We’ll focus on using Monte Carlo methods to perform hypothesis testing, in order to build on our discussions from last week. Next week, we’ll build on our intuition to develop a more formal understanding of hypothesis testing.</p>
<section id="learning-objectives" class="level2" data-number="13.1">
<h2 data-number="13.1" class="anchored" data-anchor-id="learning-objectives"><span class="header-section-number">13.1</span> Learning objectives</h2>
<p>After this lecture, you will be able to</p>
<ul>
<li>Explain the basic setup of hypothesis testing, what a null hypothesis is, and what a test statistic is.</li>
<li>Explain the interpretation of p-values as a measure of how “surprising” data is under a given null hypothesis.</li>
<li>Explain the difference between parametric and non-parametric tests.</li>
<li>Explain the permutation test and use it to test appropriate null hypotheses.</li>
</ul>
</section>
<section id="motivating-example-the-lady-tasting-tea" class="level2" data-number="13.2">
<h2 data-number="13.2" class="anchored" data-anchor-id="motivating-example-the-lady-tasting-tea"><span class="header-section-number">13.2</span> Motivating example: the lady tasting tea</h2>
<p>There is a story from the early days of modern statistics about a British woman who claimed that <a href="https://en.wikipedia.org/wiki/Lady_tasting_tea">she could tell how her tea was prepared</a>. Specifically, she claimed that she could tell whether milk was added to her tea cup before or after the tea itself was brewed.</p>
<p>This British woman was <a href="https://en.wikipedia.org/wiki/Muriel_Bristol">Muriel Bristol</a>, who was working as a researcher at the Rothamsted Experimental Station in Great Britain. It so happened that among the other researchers working at the research station was <a href="https://en.wikipedia.org/wiki/Ronald_Fisher">R. A. Fisher</a>, one of the founders of modern statistics.</p>
<p>Fisher and others at the research station were interested in finding a way to test whether Bristol’s claims were true. They devised a test wherein Bristol would be given eight cups of tea, four prepared with milk first, and four with milk added after the tea. Bristol would then be permitted to taste the eight cups of tea and would have to identify which four cups of tea she thought were prepared with milk first.</p>
<p>When they actually conducted this experiment, Bristol successfully identified the four “milk-first” cups of tea.</p>
<p><strong>The question is:</strong> was Bristol actually able to taste the difference in tea or was she just lucky?</p>
<p><strong>Said another way:</strong> how well does Bristol have to do on this task to convince us that she isn’t just a lucky guesser?</p>
</section>
<section id="better-than-chance" class="level2" data-number="13.3">
<h2 data-number="13.3" class="anchored" data-anchor-id="better-than-chance"><span class="header-section-number">13.3</span> Better than chance?</h2>
<p>The natural place to start here is to think about what we would expect to happen if Bristol were just guessing at random.</p>
<p>Let’s write code to simulate the experiment and see what happens.</p>
<p>First, we need to generate cups of tea. We’ll represent a milk-first cup as a 1, and a “milk-second” cup as a 0.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>generate_cups <span class="ot">&lt;-</span> <span class="cf">function</span>(n,k) {</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># n cups of tea; choose k of them to be "milk-first".</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># We'll represent a milk-first cup as a 1, and a "milk-second" cup as a 0.</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>  cups <span class="ot">&lt;-</span> <span class="fu">c</span>( <span class="fu">rep</span>(<span class="dv">1</span>,k), <span class="fu">rep</span>(<span class="dv">0</span>,n<span class="sc">-</span>k) ); <span class="co"># k milk-first, n-k milk-second.</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Now, randomize the order of the cups and return it.</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Randomize by sampling all n cups, WITHOUT replacement.</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>( <span class="fu">sample</span>( cups, <span class="at">size=</span>n, <span class="at">replace=</span><span class="cn">FALSE</span> ) );</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="fu">generate_cups</span>( <span class="dv">8</span>, <span class="dv">4</span>); <span class="co"># Generate eight cups with four "milk-first"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0 0 1 1 1 0 1 0</code></pre>
</div>
</div>
<p>Now, we need to generate Muriel Bristol’s guesses, in the (imaginary/hypothetical) situation where she guesses at random.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>generate_guesses <span class="ot">&lt;-</span> <span class="cf">function</span>( n,k ) {</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Generate Muriel Bristol's guesses.</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Conveniently, randomly guessing cups is the same as "generating" cups!</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>( <span class="fu">generate_cups</span>(n,k) )</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>}  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Okay, now, the last function we need: given the true cups and given Bristol’s guesses, we need to count how many she got right.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>count_correct <span class="ot">&lt;-</span> <span class="cf">function</span>( true_cups, guess_cups ) {</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># </span><span class="al">NOTE</span><span class="co">: We're assuming both vectors are binary and have the same length.</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># In "real-world" or "production" code, we would include code to check</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># that these assumptions are true and raise an error or warning to tell the</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># user if these assumptions fail,</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># but that's a matter for your programming courses.</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>( <span class="fu">sum</span>( true_cups<span class="sc">==</span>guess_cups) )</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Example</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>truecups <span class="ot">&lt;-</span> <span class="fu">generate_cups</span>( <span class="dv">8</span>, <span class="dv">4</span> )</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>guesscups <span class="ot">&lt;-</span> <span class="fu">generate_guesses</span>( <span class="dv">8</span>,<span class="dv">4</span> )</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a><span class="fu">count_correct</span>( truecups, guesscups )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 6</code></pre>
</div>
</div>
<p>Now, we’re ready. Let’s generate lots of random instances of our experiment, and see how often a randomly-guessing Muriel Bristol would get all eight cups right.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>NMC <span class="ot">&lt;-</span> <span class="dv">2000</span>;</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>ncorrect <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, NMC); <span class="co"># We'll store results in this vector</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>NMC ) {</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>  truecups <span class="ot">&lt;-</span> <span class="fu">generate_cups</span>( <span class="dv">8</span>, <span class="dv">4</span> );</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>  guesscups <span class="ot">&lt;-</span> <span class="fu">generate_cups</span>( <span class="dv">8</span>,<span class="dv">4</span> );</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>  ncorrect[i] <span class="ot">&lt;-</span> <span class="fu">count_correct</span>( truecups, guesscups );</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>( ncorrect )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="testing1_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Okay, we could certainly make that histogram look a little nicer, but that’s not the point right now. The vast majority of the time, a randomly-guessing Muriel Bristol does not get all eight cups correct– she usually gets between two and six cups correct, and most of the time she gets four correct. This isn’t shocking. We expect that on average, random guessing should get half of the cups right.</p>
<p>Now let’s recall that the real-life Muriel Bristol correctly guessed all eight of the cups correctly. In light of the above histogram, do we think it is likely that Muriel was guessing randomly? According to our Monte Carlo simulation, the probability of getting all eight cups correct when guessing randomly is</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>( ncorrect<span class="sc">==</span><span class="dv">8</span> )<span class="sc">/</span>NMC</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.012</code></pre>
</div>
</div>
<p>So, if Muriel was guessing completely randomly, she must have gotten awfully lucky!</p>
</section>
<section id="wait-that-was-hypothesis-testing" class="level2" data-number="13.4">
<h2 data-number="13.4" class="anchored" data-anchor-id="wait-that-was-hypothesis-testing"><span class="header-section-number">13.4</span> Wait, that was hypothesis testing!</h2>
<p>We didn’t make a big deal of it, but what we just did was an example of hypothesis testing, and that probability there at the end was actually a p-value!</p>
<p>Let’s think about what we did:</p>
<ol type="1">
<li>we imagined that Muriel Bristol was just guessing at random</li>
<li>we simulated what <em>would</em> have happened if Bristol had indeed been guessing at random</li>
<li>we compared what actually happened (i.e., our real data– Bristol guessing all eight cups correctly) to the simulation</li>
</ol>
<p>In this case, we found that Bristol’s eight correct cups are fairly unlikely if she had been guessing at random. <em>This is evidence <strong>against</strong> the hypothesis that she was guessing completely randomly.</em></p>
<p>Let’s think through that last point carefully–</p>
<ol type="1">
<li><em>if</em> Bristol guesses at random, we expect (based on our simulations, but also just based on common sense) that she is very unlikely to get all eight cups correct.</li>
<li>We then observed that Bristol got all eight cups correct.</li>
<li>But this is very unlikely if Bristol was guessing randomly.</li>
<li>So we conclude that Bristol was probably not guessing randomly.</li>
</ol>
<p>This is the basic idea behind hypothesis testing!</p>
<ol type="1">
<li>We start with a <em>null hypothesis</em>, and we determine what kinds of observations we would expect to see if that null hypothesis were true.</li>
<li>We collect our data.</li>
<li>We compare our observed data to what we would expect to be true under the null.</li>
<li>If our observed data is “unlikely” or “unusual” under the null, then this is evidence <em>against</em> the null hypothesis.</li>
</ol>
<p>Now, of course, the hard/interesting part of hypothesis testing is that we can actually assign probabilities to these various notions of “unlikely” and such, but at a conceptual level, that’s all there is to it!</p>
</section>
<section id="formalizing-slowly" class="level2" data-number="13.5">
<h2 data-number="13.5" class="anchored" data-anchor-id="formalizing-slowly"><span class="header-section-number">13.5</span> Formalizing (slowly)</h2>
<p>So let’s try and formalize what we did a little bit.</p>
<p>We started by assuming a null hypothesis in the form of a <em>model</em> that describes one way that the data <em>could</em> have come to be. We often write this null hypothesis <span class="math inline">\(H_0\)</span> (“H null” or “H nought”).</p>
<p>We then try to assess how likely it would be, under this null hypothesis <span class="math inline">\(H_0\)</span>, to see the data that we <em>actually</em> saw. We measure this according to a <em>p-value</em>. A p-value is a probability, measured <em>under the null hypothesis</em> of seeing the data “at least as extreme” or “at least as unusual” as the data we observed. If this probability is suitably small, we declare that we <em>reject the null hypothesis</em>.</p>
<p>So, in our example above, our null hypothesis was that Muriel Bristol was guessing completely at random. We used Monte Carlo to estimate the probability that a randomly-guessing Muriel Bristol would correctly identify all of the “milk-first” cups of tea. We estimated the probability to be about 0.0143 (the exact value in the code above will change each time we rerun it, of course, so don’t fret if this number isn’t exactly what you saw above).</p>
<p>This probability is our p-value. It captures how likely the observed data would be under our model. Since this probability is fairly small, this constitutes evidence <em>against</em> the null hypothesis. Depending on other considerations, which we will return to soon, we might decide to <em>reject</em> the null hypothesis in light of this evidence. Otherwise, we would conclude that there was insufficient evidence to reject the null hypothesis and decide to <em>accept</em> the null hypothesis.</p>
</section>
<section id="another-example-vaccine-efficacy" class="level2" data-number="13.6">
<h2 data-number="13.6" class="anchored" data-anchor-id="another-example-vaccine-efficacy"><span class="header-section-number">13.6</span> Another example: vaccine efficacy</h2>
<p>Let’s go back to Moderna’s <a href="https://investors.modernatx.com/news/news-details/2020/Modernas-COVID-19-Vaccine-Candidate-Meets-its-Primary-Efficacy-Endpoint-in-the-First-Interim-Analysis-of-the-Phase-3-COVE-Study/default.aspx">vaccine trial</a> from the Fall of 2020.</p>
<p>There were approximately 30,000 people in the trial, split (approximately) evenly between treatment (got the vaccine) and control (got a placebo).</p>
<ul>
<li>In total, there were 95 cases of COVID-19 among the participants; 90 among the placebo group and 5 among the treated group.</li>
<li>Of the 95 cases, 11 were severe cases, all in the placebo group.</li>
</ul>
<p>Suppose we have been asked to assess, using this data, whether or not the Moderna vaccine “works”, in the sense that vaccinated individuals are less likely to become ill with COVID-19.</p>
<p>For simplicity, let’s assume that the treatment and control groups were of the exact same size (I promise that this simplifying assumption will have no serious bearing on our conclusion).</p>
<p>Now, <em>if</em> the vaccine did nothing, then we would expect that any particular case of COVID would be equally likely to occur in either the treatment or control group. That is, of the 95 cases that occurred, each of the 95 are equally likely to have come from the treatment or control group.</p>
<p>Said another way, if the vaccine did nothing at all, then infecting 95 people is just like picking 95 people at random from the whole study– the control and treatment groups put together.</p>
<p>Under that assumption, our null hypothesis can be encoded in a simulation (which is really just a model!) as follows:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>generate_data <span class="ot">&lt;-</span> <span class="cf">function</span>( ncontrol, ntreatment, ncases ) {</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Simulate data.</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Generate cases in a collection of ncontrol+ntreatment study participants.</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># We will encode control participants as 1 and treatment as 0.</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>  participants <span class="ot">&lt;-</span> <span class="fu">c</span>( <span class="fu">rep</span>(<span class="dv">1</span>,ncontrol), <span class="fu">rep</span>(<span class="dv">0</span>,ntreatment));</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Now, choose ncases participants at random.</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># These are the participants who are randomly infected with COVID. Bummer!</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Note that under our null model, treatment and control participants are all</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># equally likely to be infected.</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Draw WITHOUT replacement: we want to choose ncases participants total.</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>  infected <span class="ot">&lt;-</span> <span class="fu">sample</span>( participants, <span class="at">size=</span>ncases, <span class="at">replace=</span><span class="cn">FALSE</span> )</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># We'll just return the number of control subjects who got infected.</span></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># returning sum(infected) works because the controls are</span></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># encoded as 1s in the vector `participants`.</span></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>( <span class="fu">sum</span>(infected) );</span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate for the case of 15K controls, 15K treatment, 95 cases,</span></span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a><span class="co"># like in the Moderna data.</span></span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a><span class="fu">generate_data</span>( <span class="dv">15000</span>, <span class="dv">15000</span>, <span class="dv">95</span> )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 54</code></pre>
</div>
</div>
<p>Let’s generate data a bunch of times and create a histogram, similar to with our tea-tasting example.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>NMC <span class="ot">&lt;-</span> <span class="dv">2000</span>; <span class="co"># 2000 Monte Carlo replicates of our experiment.</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>case_counts <span class="ot">&lt;-</span> <span class="fu">rep</span>( <span class="dv">0</span>, NMC );</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>( i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>NMC ) {</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>  case_counts[i] <span class="ot">&lt;-</span> <span class="fu">generate_data</span>( <span class="dv">15000</span>, <span class="dv">15000</span>, <span class="dv">95</span> );</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>( case_counts )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="testing1_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Now, in the actual trial data, there were 90 cases in the placebo group. Let’s add that point on the histogram.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>( case_counts, <span class="at">xlim=</span><span class="fu">c</span>(<span class="fu">min</span>(case_counts), <span class="dv">100</span>) )</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>( <span class="at">v=</span><span class="dv">90</span>, <span class="at">lw=</span><span class="dv">3</span>, <span class="at">col=</span><span class="st">'red'</span> )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="testing1_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Hmm… so our null model generated control case counts that are usually between 30 and 65. That is, typically, between 30 and 65 of the 95 COVID cases are in the control group when infections are completely random (i.e., treatment and control are equally likely to be infected).</p>
<p>Our actually observed data had 90 of the 95 cases in the control group, which is <strong>way</strong> outside the norm for our null model, according to our simulations.</p>
<p>What do we think about the null hypothesis, now? Is our data likely under the null hypothesis that cases are equally likely in the control and treatment groups?</p>
<p>Well, it certainly seems like our observed data is unlikely under our null hypothesis that the Moderna vaccine has no effect. But just how unlikely?</p>
<p>We <em>could</em> do a bunch of algebra to figure out just how likely our observed data is under the null, but let’s leave that to your probability classes. Instead, let’s try and estimate it using Monte Carlo. Let’s generate more data, just like our simulation above, and count how often we have 90 <em>or more</em> control subjects in our group of 95 sick patients.</p>
<p>Just a heads up: running this code may take some time– we’re generating a LOT of MC replicates. You might want to decrease the <code>1e5</code> down to more like <span class="math inline">\(5000\)</span> before running this for yourself, or else be prepared to sit for a few minutes while it runs.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>NMC <span class="ot">&lt;-</span> <span class="fl">1e5</span>; <span class="co"># 100K MC replicates</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>atleast90 <span class="ot">&lt;-</span> <span class="dv">0</span>; <span class="co"># We'll keep track of how often we get 90 or ore infected.</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>( i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>NMC ) {</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>( <span class="fu">generate_data</span>( <span class="dv">15000</span>, <span class="dv">15000</span>, <span class="dv">95</span> ) <span class="sc">&gt;=</span> <span class="dv">90</span> ) {</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>    atleast90 <span class="ot">&lt;-</span> atleast90 <span class="sc">+</span> <span class="dv">1</span>;</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a><span class="co"># To estimate our probability, what fraction of our trials "succeeded"?</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(atleast90<span class="sc">/</span>NMC)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0</code></pre>
</div>
</div>
<p>Well, unless something rather surprising happened when knitting this document, our estimated probability there should be… 0.0.</p>
<p>Now, is the true probability actually zero? No, of course not.</p>
<p>But the true probability is <em>really</em> tiny.</p>
<p>The true probability is given by (this calculation can wait for your probability classes; just take it as a given for now; look up the “hypergeometric distribution” if you’re curious)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># This is computing the probability that we see 90,91,92,93,94 or 95</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="co"># of the 95 infections in the placebo group, under the setting where</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="co"># the 95 infections are assigned randomly to the treatment and control groups.</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>( <span class="fu">dhyper</span>(<span class="fu">c</span>(<span class="dv">90</span>,<span class="dv">91</span>,<span class="dv">92</span>,<span class="dv">93</span>,<span class="dv">94</span>,<span class="dv">95</span>), <span class="dv">15000</span>,<span class="dv">15000</span>, <span class="dv">95</span>) )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.372347e-21</code></pre>
</div>
</div>
<p>Dang, that’s a tiny number!</p>
<p>Suffice it to say, then, that the probability of seeing the data that we did (or data even more “unusual”) under our null hypothesis is <em>tiny</em>. Something like <span class="math inline">\(p = 1.37 \times 10^{-21}\)</span>. That’s a p-value– again, it encodes the probability, under the null hypothesis of seeing data at least as “extreme” or “unusual” (here “extreme” can be interpreted to mean “unlikely”).</p>
<p>This is (strong!) evidence <em>against</em> the null hypothesis. If the null hypothesis were true, we would be <em>very</em> unlikely to see the data that we did, hence we conclude that the null hypothesis is probably not true. After all, if it <em>were</em> true, we would (probably) not have seen the data that we did.</p>
<p>It is pretty reasonable to, in light of this evidence, <em>reject</em> the null hypothesis that the Moderna vaccine does nothing to change susceptibility to COVID-19.</p>
</section>
<section id="formalizing-for-real-this-time" class="level2" data-number="13.7">
<h2 data-number="13.7" class="anchored" data-anchor-id="formalizing-for-real-this-time"><span class="header-section-number">13.7</span> Formalizing (for real, this time)</h2>
<p>Okay, let’s try and turn our ideas above into a bit more of a proper recipe or algorithm for performing hypothesis testing. This follows a framework called <a href="https://en.wikipedia.org/wiki/Statistical_hypothesis_testing#Neyman%E2%80%93Pearson_hypothesis_testing">Neyman-Pearson hypothesis testing</a>.</p>
<p>We begin by specifying the <em>null hypothesis</em>. Usually, this is a model that describes how things would look if there were “no effect” or if there were “no difference” between groups that we are comparing.</p>
<ul>
<li>In the case of the tea tasting example, the null hypothesis was that the taster was guessing completely at random.</li>
<li>In the case of the vaccine trial, the null hypothesis was that subjects in the treatment and control groups were equally likely to get infected with COVID.</li>
</ul>
<p>Having specified our null hypothesis, we come up with a measure of how “usual” or “unusual” data looks under the null hypothesis.</p>
<ul>
<li>In the case of our tea tasting example, this was just the number of cups that the taster guessed correctly– if this number was especially large, that would be evidence that the taster was doing much better than chance would dictate (and, I suppose, if this number is especially small, this would be evidence that the taster is especially bad at guessing).</li>
<li>In the case of our vaccine trial, this was just the number of infected subjects in the control group. If this number were especially far from about 47 (<span class="math inline">\(\approx 95/2\)</span>), that would be an indication that something was different between the two groups.</li>
</ul>
<p>Now, having come up with a measure of how “weird” a particular set of data might be, we <em>want</em> to just look at our observed data and check– was our data “weird” under the null hypothesis? But how “weird” is weird? To assess this in our examples above, we used Monte Carlo simulation to generate lots of “fake” data sets from the model. These Monte Carlo replicates provide a perfect baseline for what data <em>should</em> look like under the null hypothesis– after all, we are generating it from the null model ourselves!</p>
<p>Later on, we’ll see different ways of assessing how “usual” or “unusual” our data is (and if you think back to STAT240, you saw another way, in the context of the t-test, which we’ll revisit soon), but for now, Monte Carlo simulation is the only tool in our toolkit.</p>
<p>So, we can generate lots of copies of what the data <em>would</em> look like if the null hypothesis were true, and we can apply our measure of “weirdness” to each of these fake data sets</p>
<ul>
<li>In our tea tasting example, we generated random orderings and guesses of the eight cups of tea and counted how many cups were guessed correctly.</li>
<li>In our vaccine example, we generated lots of random choices of which 95 of the 30K participants got sick with COVID.</li>
</ul>
<p>Sometimes, having performed the above steps up to here, it will be quite clear that the null hypothesis can’t really be correct– think about our vaccine data, where 90 of 95 COVID cases being in the control group was just <em>so</em> far outside the norm. More often, though, it will not be quite so obvious, and we will want to be able to quantify <em>how</em> usual or unusual our observed data is under the null model. This is the role of p-values.</p>
</section>
<section id="introducing-p-values" class="level2" data-number="13.8">
<h2 data-number="13.8" class="anchored" data-anchor-id="introducing-p-values"><span class="header-section-number">13.8</span> Introducing p-values</h2>
<p>We’ve already seen p-values in our examples above, and you’ve hopefully seen them before in STAT240 or other introductory courses, but just in case you haven’t seen them (or if you just don’t remember), let’s start from the very beginning.</p>
<p>We want a way of capturing how “unusual” our observed data is <em>under the null hypothesis</em>. A p-value does precisely this– the p-value is the probability <em>under the null hypothesis</em> of seeing data <em>at least as extreme</em> as our observed data (if you prefer, substitute “unusual” for “extreme”, there).</p>
<p>In symbols, suppose that we have a function <span class="math inline">\(T\)</span> that takes our data and spits out a number describing how “unusual” the data is. So, if <span class="math inline">\(D\)</span> is our data (<span class="math inline">\(D\)</span> could be a sample of observations, but it could be lots of other things too, so let’s keep it purposefully vague for now), then <span class="math inline">\(T(D) \in \mathbb{R}\)</span> is a number that describes how “unusual” or “extreme” the data is.</p>
<p>This <span class="math inline">\(T\)</span> function is called our <em>test statistic</em>, because it is a summary of our data (i.e., a statistic) that we use for… our test.</p>
<p>We’ll just arbitrarily decide for now that larger values of <span class="math inline">\(T(D)\)</span> mean that the data was “more unusual”, though in some situations it might be reversed– it depends!</p>
<p>Remember, the null hypothesis is really just a statistical model that describes how the data got generated. The p-value is the probability <em>under that null hypothesis</em> of seeing data <em>at least as extreme/unusual</em> as the data we actually saw.</p>
<p>So, if the actually observed data is <span class="math inline">\(d\)</span> with test statistic <span class="math inline">\(T(d)\)</span>, and <span class="math inline">\(D_0\)</span> is <em>another</em> random copy of the data generated under <span class="math inline">\(H_0\)</span>, the p-value associated to our observed data under the null hypothesis <span class="math inline">\(H_0\)</span> is <span class="math display">\[
\Pr[ T(D_0) \ge T(d); H_0 ],
\]</span> where the semicolon notation is just to stress that this is the probability <em>under the null model</em>.</p>
<p>Reading out that probability is exactly the definition of a p-value that we laid out just a moment ago– the probability <em>under the null hypothesis</em>, that we observe data (i.e., <span class="math inline">\(D_0\)</span>, generated from the null model) that is <em>at least as extreme</em> (hence the <span class="math inline">\(\ge\)</span> symbol) as the data that we actually observed (<span class="math inline">\(d\)</span>).</p>
<p>Now, sometimes it is possible to compute this p-value (i.e., the probability above) exactly, but often it isn’t. Lucky for us, we have spent a lot of time so far this semester talking about a set of tools for <em>approximating</em> probabilities like the one above– Monte Carlo simulation!</p>
<p>Even if we can’t compute the p-value exactly, we <em>can</em> simulate data from the null model lots of times and just <em>count</em> how often the data is at least as extreme as the data we actually saw. That’s exactly what we did in our two examples above– we generated data from the null model, and counted how often the data that was generated was as unusual as our observed data.</p>
</section>
<section id="example-drug-trials" class="level2" data-number="13.9">
<h2 data-number="13.9" class="anchored" data-anchor-id="example-drug-trials"><span class="header-section-number">13.9</span> Example: drug trials</h2>
<p>Here is some (fictionalized) data from a medical trial. 40 subjects were recruited to the study and assigned randomly to either control or treatment (20 subjects in each group). Subjects were measured according to how well they responded to treatment. Let’s say that larger numbers are “better” for the sake of example.</p>
<p>Here is the data:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>control <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.10</span>, <span class="sc">-</span><span class="fl">0.55</span>, <span class="fl">1.24</span>, <span class="sc">-</span><span class="fl">0.97</span>, <span class="sc">-</span><span class="fl">0.76</span>,  <span class="fl">0.21</span>,<span class="sc">-</span><span class="fl">0.27</span>, <span class="sc">-</span><span class="fl">1.02</span>, <span class="fl">0.58</span>, <span class="fl">1.67</span>, <span class="sc">-</span><span class="fl">1.07</span>, <span class="fl">0.17</span>, <span class="fl">1.45</span>, <span class="fl">0.34</span>, <span class="fl">1.15</span>, <span class="fl">0.18</span>, <span class="sc">-</span><span class="fl">0.97</span>, <span class="fl">0.43</span>, <span class="sc">-</span><span class="fl">1.39</span>, <span class="sc">-</span><span class="fl">2.76</span> );</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>treatment <span class="ot">&lt;-</span> <span class="fu">c</span>( <span class="fl">0.54</span>, <span class="fl">0.36</span>, <span class="fl">0.59</span>, <span class="sc">-</span><span class="fl">0.57</span>, <span class="fl">0.53</span>, <span class="sc">-</span><span class="fl">0.78</span>, <span class="sc">-</span><span class="fl">0.44</span>, <span class="sc">-</span><span class="fl">0.98</span>, <span class="fl">1.31</span>, <span class="fl">0.50</span>, <span class="fl">0.57</span>, <span class="fl">0.49</span>, <span class="sc">-</span><span class="fl">0.96</span>, <span class="fl">2.41</span>, <span class="fl">0.85</span>, <span class="fl">1.93</span>, <span class="fl">0.95</span>, <span class="fl">1.45</span>, <span class="fl">1.61</span>, <span class="sc">-</span><span class="fl">1.16</span> );</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>How might we go about testing the hypothesis <span class="math display">\[
H_0 : \text{ treatment has no effect. }
\]</span></p>
<p><strong>Question:</strong> let’s pause and discuss what this null hypothesis <em>actually</em> means.</p>
<p>That is, “in math”, or in terms of our <em>model</em> of how the data came to be, what do we mean when we say that treatment has no effect?</p>
<p>Do we mean that the control and treatment groups have exactly the same distribution?</p>
<p>Or do we mean just that they have the same mean? or the same variance, or the same kurtosis or…?</p>
<p>Different answers to this question might (and often do!) lead us to use different testing procedures.</p>
<section id="reminder-parametric-testing" class="level3" data-number="13.9.1">
<h3 data-number="13.9.1" class="anchored" data-anchor-id="reminder-parametric-testing"><span class="header-section-number">13.9.1</span> Reminder: parametric testing</h3>
<p>In STAT240, you may have seen the simple setting where we assume that the two groups are both normally distributed with the same <em>known</em> variance but (possibly) different means.</p>
<p>Alternatively (again, depending on when you took STAT240), you might have seen (unpaired) two-sample t-tests, where we assumed that the data came from a normal distribution, but with an unknown variance (Student’s t-test) or two normals with the same mean but possibly different variances (Welch’s t-test).</p>
<p>In either of these cases, we might write <span class="math display">\[
H_0 : \mu_{\text{control}} = \mu_{\text{treatment}},
\]</span></p>
<p>even though the model assumptions that we make are different for these two different null hypotheses.</p>
<p>The important point here is to be careful about exactly what assumptions we are making about the data when we conduct a test.</p>
<p>In the case of the testing examples that you saw in STAT240, we always assumed that the data came from a specific model, then we computed a quantity that is motivated by the parameters of that model (i.e., we are secretly trying to <em>estimate</em> certain parameters of the model, a topic we’ll discuss more soon). So here we might do something like the following to conduct an unpaired two-sample t-test (in particular, here we’re assuming that under the null, the two groups came from normals with the same mean and the same variances):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>s_control <span class="ot">&lt;-</span> <span class="fu">sd</span>( control );</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>s_treatment <span class="ot">&lt;-</span> <span class="fu">sd</span>( treatment );</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>s_pooled <span class="ot">&lt;-</span> <span class="fu">sqrt</span>( (s_control<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> s_treatment<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span><span class="dv">2</span> );</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Form the t-statistic. See, e.g.,</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="co"># https://en.wikipedia.org/wiki/Student's_t-test#Unpaired_and_paired_two-sample_t-tests</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(control); <span class="co"># n = n_1 = n_2, i.e., same sample sizes</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>t <span class="ot">&lt;-</span> (<span class="fu">mean</span>(treatment)<span class="sc">-</span><span class="fu">mean</span>(control))<span class="sc">/</span>(s_pooled<span class="sc">*</span><span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">/</span>n));</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>t</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.743728</code></pre>
</div>
</div>
<p>And we could compute the degrees of freedom of this t-statistic (<span class="math inline">\(n_1 + n_2-2 = 78\)</span>, in this case), and use a t-table to determine a p-value:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> <span class="sc">-</span> <span class="fu">pt</span>( t, <span class="at">df=</span><span class="fu">length</span>(control)<span class="sc">+</span><span class="fu">length</span>(treatment)<span class="sc">-</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.04464634</code></pre>
</div>
</div>
<p>That’s a reasonably small number, indicating that our observed data is not very likely under the null hypothesis that the means are the same.</p>
<p>Now, the nitty-gritty details of the above (e.g., whether to use Welch’s t-test vs Student’s t-test) are not important, here (<strong>Note:</strong> that isn’t to say that it isn’t important! Just that it isn’t the point right now), but this general procedure should be at least broadly familiar to you from STAT240 and/or other intro courses.</p>
<p>This is an approach called <em>parametric</em> testing. We assume a <em>parametric</em> model for the data. That is, a model where the data is generated according to random variables whose distributions are controlled by parameters (e.g., the normal, binomial, etc.). The process of statistical testing then amounts to fitting a parametric model, by estimating those parameters from the data. That is why, for example, the sample means and standard deviations show up in the t-statistic.</p>
<p>Having fit the parameters from the data, we have a model– the model that “best fits” the data (again, we’ll have lots to say soon about exactly what that means, but let’s leave it vague for now). We can then use that model to assess how likely our <em>actually observed</em> data is.</p>
<p>This is a perfectly fine approach, especially when we have good reason to believe that our data came from a specific distribution (or is well-approximated by such a distribution– all models are wrong!).</p>
<p>But what if those assumptions are unrealistic, or if we just don’t want to make those assumptions?</p>
<p>The examples we’ve seen so far in this lecture (well, before our t-statistic example just now) rely on a different approach, called <em>non-parametric</em> testing, so-called because we are not making any parametric assumptions about where our data came from. That is, we are not assuming anything about our data coming from a normal, or Bernoulli or Poisson or etc.</p>
<p>Let’s look at a more general non-parametric test to get a better idea of what we mean.</p>
</section>
</section>
<section id="permutation-tests" class="level2" data-number="13.10">
<h2 data-number="13.10" class="anchored" data-anchor-id="permutation-tests"><span class="header-section-number">13.10</span> Permutation tests</h2>
<p>Without a doubt the most common and widely used non-parametric test is the <em>permutation test</em>.</p>
<p>To illustrate it, let’s recall our (fictional) drug trial data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>control <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.10</span>, <span class="sc">-</span><span class="fl">0.55</span>, <span class="fl">1.24</span>, <span class="sc">-</span><span class="fl">0.97</span>, <span class="sc">-</span><span class="fl">0.76</span>,  <span class="fl">0.21</span>,<span class="sc">-</span><span class="fl">0.27</span>, <span class="sc">-</span><span class="fl">1.02</span>, <span class="fl">0.58</span>, <span class="fl">1.67</span>, <span class="sc">-</span><span class="fl">1.07</span>, <span class="fl">0.17</span>, <span class="fl">1.45</span>, <span class="fl">0.34</span>, <span class="fl">1.15</span>, <span class="fl">0.18</span>, <span class="sc">-</span><span class="fl">0.97</span>, <span class="fl">0.43</span>, <span class="sc">-</span><span class="fl">1.39</span>, <span class="sc">-</span><span class="fl">2.76</span> );</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>treatment <span class="ot">&lt;-</span> <span class="fu">c</span>( <span class="fl">0.54</span>, <span class="fl">0.36</span>, <span class="fl">0.59</span>, <span class="sc">-</span><span class="fl">0.57</span>, <span class="fl">0.53</span>, <span class="sc">-</span><span class="fl">0.78</span>, <span class="sc">-</span><span class="fl">0.44</span>, <span class="sc">-</span><span class="fl">0.98</span>, <span class="fl">1.31</span>, <span class="fl">0.50</span>, <span class="fl">0.57</span>, <span class="fl">0.49</span>, <span class="sc">-</span><span class="fl">0.96</span>, <span class="fl">2.41</span>, <span class="fl">0.85</span>, <span class="fl">1.93</span>, <span class="fl">0.95</span>, <span class="fl">1.45</span>, <span class="fl">1.61</span>, <span class="sc">-</span><span class="fl">1.16</span> );</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We want to test the null hypothesis that the drug has no effect, but we want to do so <em>without</em> making any assumptions about the specific distribution (e.g., normal, exponential, Poisson, etc.) that gave rise to the data. That is, we want to conduct a <em>non-parametric</em> test of the hypothesis <span class="math display">\[
H_0 : F_{\text{control}} = F_{\text{treatment}},
\]</span></p>
<p>where <span class="math inline">\(F_{\text{control}}\)</span> is the distribution of the control subjects and <span class="math inline">\(F_{\text{treatment}}\)</span> is the distribution of the treatment subjects.</p>
<p>We need to start with a test statistic. Our test statistic should capture how different or alike our two samples are. There are lots of possible choices, here, but what better choice than the difference in the means?</p>
<p>Let’s start by computing the means of the two groups:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>Xbar_ctl <span class="ot">&lt;-</span> <span class="fu">mean</span>(control);</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>Xbar_trt <span class="ot">&lt;-</span> <span class="fu">mean</span>(treatment);</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>( Xbar_ctl, Xbar_trt )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.122  0.460</code></pre>
</div>
</div>
<p>The difference between these two means is</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>Xbar_trt <span class="sc">-</span> Xbar_ctl</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.582</code></pre>
</div>
</div>
<p>Well, is that a big difference or not? As we’ve seen, the whole point of statistical testing is to assess whether or not this is <em>statistically</em> big (and, okay, we already looked at this with the t-test above, but let’s press on…).</p>
<p>The permutation test is a very general tool for testing this.</p>
<p>Let’s recall that our null hypothesis is that the control and treatment patients have the same distribution.</p>
<p>The basic recipe for statistical hypothesis testing is to assume this null is true and then generate data as it would look <em>if that null were true</em>.</p>
<p>So, the permutation test assumes that the two groups, control and treatment, came from the same distribution (<span class="math inline">\(H_0: F_{\text{control}} = F_{\text{treatment}}\)</span>), and generates copies of what the data <em>could</em> have looked like if the null were true.</p>
<p><strong>Million dollar question:</strong> How do we do that, if we don’t make any assumptions about what that distribution looks like (i.e., normal, binomial, etc)?</p>
<p>Well, if the data all came from the same distribution (again, <span class="math inline">\(H_0: F_{\text{control}} = F_{\text{treatment}}\)</span>), then any reshuffling of the data was equally likely– any observation in the control group was just as likely to be seen in the treatment group, and vice versa.</p>
<p>Okay, but how does that give us a distribution? Well, it doesn’t.</p>
<p>To estimate the distribution of the test statistic under the null distribution, the permutation test repeatedly <em>permutes</em> the data, reassigning the observations to groups randomly, and compares the means again.</p>
<p>Said another way, we repeatedly reshuffle the data, reassigning the observations randomly to the treatment and control groups, and recomputing the test statistic.</p>
<p>Under the null hypothesis, all of these “reshufflings” of the data were equally likely, so all of these test statistics are drawn from the null distribution!</p>
<p><strong>Important point:</strong> the permutation test is a Monte Carlo method! To estimate the behavior of the test statistic under the null, we are going to repeatedly reshuffle the data and recompute the difference of the means!</p>
<p>Okay, let’s go ahead an implement that. We want a function in R that</p>
<ol type="1">
<li>Reshuffles the control and treatment data randomly</li>
<li>Assigns the shuffled data to control and treatment groups of the same sizes as the original ones</li>
<li>Computes our test statistic on the reshuffled data (in this case, we’re taking the test statistic to be the difference of means, but we <em>could</em> make a different choice if we really wanted).</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>permute_and_compute <span class="ot">&lt;-</span> <span class="cf">function</span>( ctrl_data, trmt_data ) {</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ctrl_data and trmt_data are vectors storing our control and treatment data</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># We are going to pretend that these two data sets came from the same</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># distribution. That means</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 1) pooling them and randomly reassigning them</span></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>  <span class="co">#     to the treatment and control groups.</span></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># and then</span></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 2) Computing our test statistic (the difference in means) on that</span></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>  <span class="co">#     new "version" of the data.</span></span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Pool the data</span></span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>  pooled_data <span class="ot">&lt;-</span> <span class="fu">c</span>( ctrl_data, trmt_data );</span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Randomly shuffle the data and assign it to control and treatment groups.</span></span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a>  n_ctrl <span class="ot">&lt;-</span> <span class="fu">length</span>( ctrl_data );</span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a>  n_trmt <span class="ot">&lt;-</span> <span class="fu">length</span>( trmt_data );</span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a>  n_total <span class="ot">&lt;-</span> n_ctrl <span class="sc">+</span> n_trmt;</span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Now, let's shuffle the data, and assign the first n_ctrl elements</span></span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true" tabindex="-1"></a>  <span class="co"># to the control group, and the rest to the treatment group.</span></span>
<span id="cb27-19"><a href="#cb27-19" aria-hidden="true" tabindex="-1"></a>  <span class="co"># We're going to do this using the sample() function.</span></span>
<span id="cb27-20"><a href="#cb27-20" aria-hidden="true" tabindex="-1"></a>  <span class="co"># To randomly shuffle the data, it's enough to sample from the</span></span>
<span id="cb27-21"><a href="#cb27-21" aria-hidden="true" tabindex="-1"></a>  <span class="co"># original data (i.e., the pooled data) WITHOUT replacement.</span></span>
<span id="cb27-22"><a href="#cb27-22" aria-hidden="true" tabindex="-1"></a>  <span class="co"># The result is that shuffled_data contains the same elements as</span></span>
<span id="cb27-23"><a href="#cb27-23" aria-hidden="true" tabindex="-1"></a>  <span class="co"># pooled_data, just in a (random) different order.</span></span>
<span id="cb27-24"><a href="#cb27-24" aria-hidden="true" tabindex="-1"></a>  shuffled_data <span class="ot">&lt;-</span> <span class="fu">sample</span>( pooled_data, <span class="at">size=</span>n_total, <span class="at">replace=</span><span class="cn">FALSE</span> );</span>
<span id="cb27-25"><a href="#cb27-25" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Now, the first n_ctrl of these data points are our new control group</span></span>
<span id="cb27-26"><a href="#cb27-26" aria-hidden="true" tabindex="-1"></a>  <span class="co"># and the remaining elements are assigned to our treatment group.</span></span>
<span id="cb27-27"><a href="#cb27-27" aria-hidden="true" tabindex="-1"></a>  shuffled_ctrl <span class="ot">&lt;-</span> shuffled_data[<span class="dv">1</span><span class="sc">:</span>n_ctrl];</span>
<span id="cb27-28"><a href="#cb27-28" aria-hidden="true" tabindex="-1"></a>  shuffled_trmt <span class="ot">&lt;-</span> shuffled_data[(n_ctrl<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n_total];</span>
<span id="cb27-29"><a href="#cb27-29" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Okay, last step: compute the difference in means of our two samples.</span></span>
<span id="cb27-30"><a href="#cb27-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>( <span class="fu">mean</span>(shuffled_trmt)<span class="sc">-</span><span class="fu">mean</span>(shuffled_ctrl) );</span>
<span id="cb27-31"><a href="#cb27-31" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now, the permutation test just says we should do that shuffling operation that we just implemented lots of times. That will give us a bunch of Monte Carlo replicates of the behavior of our test statistic under the null, and we can compare the test statistic that we <em>actually</em> observed to that null distribution.</p>
<p>Hopefully this recipe is familiar by now– we generate lots of data under the null hypothesis, compute the test statistic on each of those “fake” data sets, and compare our actually observed test statistic to the distribution of our “fake” data.</p>
<p>So let’s try that.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>NMC <span class="ot">&lt;-</span> <span class="fl">1e4</span>; <span class="co"># Might want to increase this to more like 1e5 for better accuracy</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>test_statistics <span class="ot">&lt;-</span> <span class="fu">rep</span>( <span class="dv">0</span>, NMC ); <span class="co"># Vector to store our "fake" test statistics</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Now, NMC times, shuffle the data, recompute the test statistic, and record.</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>NMC ) {</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>  test_statistics[i] <span class="ot">&lt;-</span> <span class="fu">permute_and_compute</span>( control, treatment );</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Now, let's make a histogram of those permuted test statistics.</span></span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>( test_statistics )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="testing1_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>And now let’s put our actually observed test statistic in that plot.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>( test_statistics )</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>( <span class="at">v=</span><span class="fu">mean</span>(treatment)<span class="sc">-</span><span class="fu">mean</span>(control), <span class="at">lw=</span><span class="dv">3</span>, <span class="at">col=</span><span class="st">'red'</span> )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="testing1_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Well, that looks at least reasonably extreme.</p>
<p>Can we associate this with a p-value? Of course! At least, an estimated p-value (<strong>why?</strong> because that histogram is just simulated data! not the <em>exact</em> distribution!).</p>
<p>Remember, we just need to estimate the probability that test statistic under the null is <em>at least</em> as big as our observed test statistic.</p>
<p>That is, we want to estimate <span class="math inline">\(\Pr[ T(D) \ge t]\)</span>, where <span class="math inline">\(T(D)\)</span> is the test statistic under the null and <span class="math inline">\(t\)</span> is the actually observed test statistic.</p>
<p>We estimate that probability with Monte Carlo just like we saw last week. We just count how often that event happened in our simulation:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>Tobsd <span class="ot">&lt;-</span> <span class="fu">mean</span>(treatment) <span class="sc">-</span> <span class="fu">mean</span>(control); <span class="co"># Actually observed test statistic</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Monte Carlo estimate: how often in our simulation did the "fake" data</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a><span class="co"># have a difference in means greater than or equal to Tobsd?</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(test_statistics <span class="sc">&gt;=</span> Tobsd)<span class="sc">/</span>NMC;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.0474</code></pre>
</div>
</div>
<p>So that’s a (approximate! don’t forget that this is estimated using Monte Carlo!) p-value of <span class="math inline">\(0.0434\)</span>. That’s a reasonably small probability that the difference in distributions is merely due to chance.</p>
<p>Once again, this is evidence <em>against</em> the null hypothesis that the control and treatment groups had the same distribution.</p>
<p>If they <em>did</em> have the same distribution, we would expect our observed difference in means to be quite a bit smaller– as things stand, our observed test statistic appears fairly unlikely under the null!</p>
<p>Next week’s lectures will focus on how we decide how unlikely is unlikely enough for us to “reject” the null hypothesis.</p>
<section id="review" class="level3" data-number="13.10.1">
<h3 data-number="13.10.1" class="anchored" data-anchor-id="review"><span class="header-section-number">13.10.1</span> Review:</h3>
<p>In these notes we covered:</p>
<ul>
<li>Formulating a decision into a null and alternative hypothesis</li>
<li>Randomization tests (model-based)</li>
<li>Permutation tests (two-sample)</li>
<li>Simulating a distribution of test statistics</li>
<li>Calculation of one or two-tailed <span class="math inline">\(p\)</span>-values from simulated distribution of test statistics</li>
<li>Interpretation of a <span class="math inline">\(p\)</span>-value</li>
</ul>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./R_MonteCarlo_Battleship.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Monte Carlo Battleship</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./R04_Monte_Carlo_Testing.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Monte Carlo Testing</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>