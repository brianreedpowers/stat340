<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>28&nbsp; Prediction (Multiple Linear Regression) – STAT 340: Data Science II</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./R09_Multiple_Regression.html" rel="next">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./prediction1.html">Prediction</a></li><li class="breadcrumb-item"><a href="./prediction2.html"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Prediction (Multiple Linear Regression)</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">STAT 340: Data Science II</a> 
        <div class="sidebar-tools-main">
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">STAT 340 Index</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="false">
 <span class="menu-text">Sampling</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rv.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Random Variables</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./R01_RandomVariables.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Random Variables R Examples</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rv_practice.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Probability and Random Variables Practice</span></span></a>
  </div>
</li>
          <li class="px-0"><hr class="sidebar-divider hi "></li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./cov.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Independence, Conditional Probability and Bayes’ Rule</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./R02_IndepCondBayes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Independence, Conditional Probability and Bayes Theorem R Examples</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./cov_practice.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Independence and Conditional Probability Practice</span></span></a>
  </div>
</li>
          <li class="px-0"><hr class="sidebar-divider hi "></li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./mc.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Monte Carlo</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./R03_MonteCarloExamples.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Monte Carlo Examples</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./mc_practice.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Monte Carlo Practice</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./R_MonteCarlo_Battleship.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Monte Carlo Battleship</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false">
 <span class="menu-text">Testing</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./testing1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Introduction to Statistical Testing</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./R04_Monte_Carlo_Testing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Monte Carlo Testing</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./testing1_practice.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Monte Carlo Testing Practice</span></span></a>
  </div>
</li>
          <li class="px-0"><hr class="sidebar-divider hi "></li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./testing2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Statistical Testing, Continued</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./R05_testing_Additional_Examples.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Monte Carlo Testing: Additional Examples</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./testing2_practice.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Testing and Power Practice</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false">
 <span class="menu-text">Estimation</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./estimation1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Estimation Part 1</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./estimation1_practice.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Point Estimation Practice</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./R06_More_Estimation_Examples.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Estimation Examples</span></span></a>
  </div>
</li>
          <li class="px-0"><hr class="sidebar-divider hi "></li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./estimation2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Estimation Part 2</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./estimation2_practice.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Interval Estimation Practice</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./R07_More_Estimation_and_CI_Examples.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Interval Estimation Examples</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">Prediction</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./prediction1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Prediction (Simple Linear Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./slr_practice.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Simple Linear Regression Practice</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./R08_prediction_examples.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Simple Linear Regression - Examples</span></span></a>
  </div>
</li>
          <li class="px-0"><hr class="sidebar-divider hi "></li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./prediction2.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Prediction (Multiple Linear Regression)</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./R09_Multiple_Regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">R10 multiple regression further concepts</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./mlr_practice.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">30</span>&nbsp; <span class="chapter-title">Multiple Linear Regression Practice</span></span></a>
  </div>
</li>
          <li class="px-0"><hr class="sidebar-divider hi "></li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./logistic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">31</span>&nbsp; <span class="chapter-title">Logistic Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./R10_LogisticReg_Extended.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">32</span>&nbsp; <span class="chapter-title">Logistic Regression - Extended Examples</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./logistic_practice.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">33</span>&nbsp; <span class="chapter-title">Logistic Regression Practice</span></span></a>
  </div>
</li>
          <li class="px-0"><hr class="sidebar-divider hi "></li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./cv.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">34</span>&nbsp; <span class="chapter-title">Model Selection and Cross Validation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./R11_cv-MSEcomparison.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">35</span>&nbsp; <span class="chapter-title">cv-extra</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./R11_Bias_Variance.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">36</span>&nbsp; <span class="chapter-title">Bias Variance Tradeoff</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./R11_Model_Selection.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">37</span>&nbsp; <span class="chapter-title">R11 Model Selection</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./R11_Ridge_LASSO.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">38</span>&nbsp; <span class="chapter-title">R11: Ridge and Lasso</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./cv_practice.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">39</span>&nbsp; <span class="chapter-title">Cross Validation Practice</span></span></a>
  </div>
</li>
          <li class="px-0"><hr class="sidebar-divider hi "></li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="false">
 <span class="menu-text">Bootstrapping</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./bootstrap.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">40</span>&nbsp; <span class="chapter-title">Bootstrapping</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./R12_Bootstrap_Examples.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">41</span>&nbsp; <span class="chapter-title">R13_Bootstrap</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./bootstrap_practice.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">42</span>&nbsp; <span class="chapter-title">Bootstrap Practice</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="false">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./RV_summary.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Random Variable Summary</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#multiple-regression" id="toc-multiple-regression" class="nav-link active" data-scroll-target="#multiple-regression"><span class="header-section-number">28.1</span> Multiple regression</a>
  <ul class="collapse">
  <li><a href="#specifying-multiple-predictors" id="toc-specifying-multiple-predictors" class="nav-link" data-scroll-target="#specifying-multiple-predictors"><span class="header-section-number">28.1.1</span> Specifying multiple predictors</a></li>
  <li><a href="#example-the-mtcars-dataset" id="toc-example-the-mtcars-dataset" class="nav-link" data-scroll-target="#example-the-mtcars-dataset"><span class="header-section-number">28.1.2</span> Example: the <code>mtcars</code> dataset</a></li>
  <li><a href="#interpreting-estimated-coefficients" id="toc-interpreting-estimated-coefficients" class="nav-link" data-scroll-target="#interpreting-estimated-coefficients"><span class="header-section-number">28.1.3</span> Interpreting estimated coefficients</a></li>
  </ul></li>
  <li><a href="#assessing-model-fit" id="toc-assessing-model-fit" class="nav-link" data-scroll-target="#assessing-model-fit"><span class="header-section-number">28.2</span> Assessing model fit</a>
  <ul class="collapse">
  <li><a href="#assessing-model-fit-with-rss" id="toc-assessing-model-fit-with-rss" class="nav-link" data-scroll-target="#assessing-model-fit-with-rss"><span class="header-section-number">28.2.1</span> Assessing model fit with RSS</a></li>
  <li><a href="#what-constitutes-a-good-fit" id="toc-what-constitutes-a-good-fit" class="nav-link" data-scroll-target="#what-constitutes-a-good-fit"><span class="header-section-number">28.2.2</span> What constitutes a good fit?</a></li>
  <li><a href="#assessing-model-fit-with-r2" id="toc-assessing-model-fit-with-r2" class="nav-link" data-scroll-target="#assessing-model-fit-with-r2"><span class="header-section-number">28.2.3</span> Assessing model fit with <span class="math inline">\(R^2\)</span></a></li>
  <li><a href="#assessing-fit-another-way-mss" id="toc-assessing-fit-another-way-mss" class="nav-link" data-scroll-target="#assessing-fit-another-way-mss"><span class="header-section-number">28.2.4</span> Assessing fit another way: MSS</a></li>
  <li><a href="#assessing-model-fit-with-the-f-distribution" id="toc-assessing-model-fit-with-the-f-distribution" class="nav-link" data-scroll-target="#assessing-model-fit-with-the-f-distribution"><span class="header-section-number">28.2.5</span> Assessing model fit with the F-distribution</a></li>
  </ul></li>
  <li><a href="#looking-ahead-model-selection" id="toc-looking-ahead-model-selection" class="nav-link" data-scroll-target="#looking-ahead-model-selection"><span class="header-section-number">28.3</span> Looking ahead: model selection</a></li>
  <li><a href="#mo-predictors-mo-problems" id="toc-mo-predictors-mo-problems" class="nav-link" data-scroll-target="#mo-predictors-mo-problems"><span class="header-section-number">28.4</span> Mo’ predictors mo’ problems</a>
  <ul class="collapse">
  <li><a href="#handling-categorical-predictors" id="toc-handling-categorical-predictors" class="nav-link" data-scroll-target="#handling-categorical-predictors"><span class="header-section-number">28.4.1</span> Handling categorical predictors</a></li>
  </ul></li>
  <li><a href="#interactions" id="toc-interactions" class="nav-link" data-scroll-target="#interactions"><span class="header-section-number">28.5</span> Interactions</a></li>
  <li><a href="#nonlinear-transformations" id="toc-nonlinear-transformations" class="nav-link" data-scroll-target="#nonlinear-transformations"><span class="header-section-number">28.6</span> Nonlinear transformations</a></li>
  <li><a href="#review" id="toc-review" class="nav-link" data-scroll-target="#review"><span class="header-section-number">28.7</span> Review</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./prediction1.html">Prediction</a></li><li class="breadcrumb-item"><a href="./prediction2.html"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Prediction (Multiple Linear Regression)</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Prediction (Multiple Linear Regression)</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>Last week, we discussed simple linear regression, wherein we predict a <em>response</em> <span class="math inline">\(Y\)</span> based on a single <em>predictor</em> <span class="math inline">\(X\)</span>, according to the model <span class="math display">\[
Y = \beta_0 + \beta_1 X.
\]</span></p>
<p>In lecture, we had an extended discussion of predicting crime rates (on a 22 year lag) based on levels of lead in the atmosphere. That is, our predictor was lead level (measured in metric tons) and our response was aggravated assaults per million people. We predicted a <em>single</em> response from a <em>single</em> predictor– nice and… simple?</p>
<div style="page-break-after: always;"></div>
<p>But of course in reality, there are lots of things beyond lead levels that might have an effect on crime rates, and which we might like to use to predict crime rates. Examples include availability of social services, amounts of green space in a city, population density, income inequality… I’m sure you can think of plenty others.</p>
<p>How might we build a model that uses <em>multiple</em> predictors, rather than a single one, to predict our response? Well, this is precisely the idea behind <em>multiple linear regression</em>, our focus this week.</p>
<div style="page-break-after: always;"></div>
<section id="multiple-regression" class="level2" data-number="28.1">
<h2 data-number="28.1" class="anchored" data-anchor-id="multiple-regression"><span class="header-section-number">28.1</span> Multiple regression</h2>
<p>Everything so far is likely (mostly) familiar to you from STAT240: regressing one variable against another. What happens, however, when we want to incorporate multiple different predictors in our model?</p>
<div style="page-break-after: always;"></div>
<p><strong>Example: salary and education</strong> Recall from last week’s lecture our data set relating salaries to years of education. We noted that there were many other factors that might predict salary in addition to simply years of education, and that their inclusion in our model would improve our predictive accuracy. For example, we might add additional information concerning college major, demographic information, parents’ level of education, etc.</p>
<div style="page-break-after: always;"></div>
<p><strong>Example: housing prices</strong> Suppose that we are looking to invest in real estate. To do that, it would be quite useful if we could predict, based on what we know about a house, how much that house is likely to sell for. One approach would be to predict housing price based on a collection of information such as square footage, age of the house, number of bedrooms, proximity to parks, etc.</p>
<div style="page-break-after: always;"></div>
<section id="specifying-multiple-predictors" class="level3" data-number="28.1.1">
<h3 data-number="28.1.1" class="anchored" data-anchor-id="specifying-multiple-predictors"><span class="header-section-number">28.1.1</span> Specifying multiple predictors</h3>
<p>How do we go about adding more variables to our model?</p>
<p>Well, it’s basically as simple as you would imagine. We just add more predictors (and more coefficients) to our linear function. If we have <span class="math inline">\(p\)</span> predictors plus an intercept, we predict the response <span class="math inline">\(y\)</span> according to <span class="math display">\[
y = \beta_0 + \beta_1 x_1 + \beta_2 x_2 + \cdots + \beta_{p-1} x_{p-1} + \beta_p x_p,
\]</span></p>
<p>where <span class="math inline">\(x_1,x_2,\dots,x_p \in \mathbb{R}\)</span> are predictors.</p>
<div style="page-break-after: always;"></div>
<p>Similarly, our model now takes the form that for each <span class="math inline">\(i=1,2,\dots,n\)</span>, we observe <span class="math display">\[
Y_i = \beta_0 + \beta_1 X_{i,1} + \beta_2 X_{i,2} + \cdots + \beta_{p-1} X_{i,p-1} + \beta_p X_{i,p} + \epsilon_i,
\]</span></p>
<p>where <span class="math inline">\(\epsilon_i\)</span> is an error term (again, assumed normally distributed, independent over <span class="math inline">\(i\)</span>, etc) and <span class="math inline">\(X_i = (X_{i,1},X_{i,2},\dots,X_{i,p})^T \in \mathbb{R}^p\)</span> is a vector of predictors. If you haven’t taken linear algebra or you just don’t like vectors, not to worry– it’s perfectly safe to think of this as just a list of numbers in this class. But linear algebra is awesome and super useful if you want to understand machine learning methods, so I recommend that you take linear algebra if you haven’t already!</p>
<p><strong>Note:</strong> some resources will use this notation “backward”, instead writing <span class="math inline">\((X_{1,i}, X_{2,i}, \dots, X_{p-1,i}, X_{p,i})\)</span> for the predictors. The distinction doesn’t matter much, so long as you’re consistent.</p>
<p>A convenient way to think about our data set, then, is to make an array of numbers (i.e., a matrix), in which each row corresponds to an observation, and each column corresponds to a predictor: <span class="math display">\[
\bf{X} =
\begin{bmatrix}
X_{1,1} &amp; X_{1,2} &amp; \cdots &amp; X_{1,p} \\
X_{2,1} &amp; X_{2,2} &amp; \cdots &amp; X_{2,p} \\
\vdots &amp; \vdots   &amp; \ddots &amp; \vdots \\
X_{n-1,1} &amp; X_{n-1,2} &amp; \cdots &amp; X_{n-1,p} \\
X_{n,1} &amp; X_{n,2} &amp; \cdots &amp; X_{n,p}
\end{bmatrix}
\]</span></p>
<p>The nice thing about this is that we can tack on a column of ones corresponding to our intercept term, <span class="math display">\[
\bf{X} =
\begin{bmatrix}
1 &amp; X_{1,1} &amp; X_{1,2} &amp; \cdots &amp; X_{1,p} \\
1 &amp; X_{2,1} &amp; X_{2,2} &amp; \cdots &amp; X_{2,p} \\
\vdots &amp; \vdots &amp; \vdots  &amp; \ddots &amp; \vdots \\
1 &amp; X_{n-1,1} &amp; X_{n-1,2} &amp; \cdots &amp; X_{n-1,p} \\
1&amp; X_{n,1} &amp; X_{n,2} &amp; \cdots &amp; X_{n,p}
\end{bmatrix}
\]</span></p>
<p>and then (if you don’t know linear algebra, it’s okay to just skip this! It won’t be on an exam, it’s just a useful connection to another area that some students have seen before!), we can write our regression formula <span class="math display">\[
y_i = \beta_0 + \beta_1 x_{i,1} + \beta_2 x_{i,2} + \cdots + \beta_p x_{i,p}~~~\text{ for } i = 1,2,\dots,n
\]</span> as a matrix-vector equation, <span class="math display">\[
\bf{y} = \bf{X} \bf{\beta}
\]</span> where <span class="math inline">\(\bf{y} = (y_1,y_2,\dots, y_n)^T\)</span> is a vector of our responses, and <span class="math inline">\(\bf{\beta} = (\beta_0,\beta_1, \beta_2, \dots, \beta_p)^T\)</span> is a vector of our coefficients.</p>
<p>Again, if you haven’t taken linear algebra before, you can safely ignore the above. It won’t be on an exam or a homework or anything like that, I’ve just included it for students who are familiar with linear algebra to illustrate a connection to another area of math!</p>
</section>
<section id="example-the-mtcars-dataset" class="level3" data-number="28.1.2">
<h3 data-number="28.1.2" class="anchored" data-anchor-id="example-the-mtcars-dataset"><span class="header-section-number">28.1.2</span> Example: the <code>mtcars</code> dataset</h3>
<p>Let’s recall the <code>mtcars</code> data set, which includes a number of variables describing the specifications and performance of a collection of car brands.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(mtcars)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                   mpg cyl disp  hp drat    wt  qsec vs am gear carb
Mazda RX4         21.0   6  160 110 3.90 2.620 16.46  0  1    4    4
Mazda RX4 Wag     21.0   6  160 110 3.90 2.875 17.02  0  1    4    4
Datsun 710        22.8   4  108  93 3.85 2.320 18.61  1  1    4    1
Hornet 4 Drive    21.4   6  258 110 3.08 3.215 19.44  1  0    3    1
Hornet Sportabout 18.7   8  360 175 3.15 3.440 17.02  0  0    3    2
Valiant           18.1   6  225 105 2.76 3.460 20.22  1  0    3    1</code></pre>
</div>
</div>
<p>Let’s suppose that we are interested in predicting the quarter mile time (<code>qsec</code>, the time it takes the car to go 1/4 mile from a dead stop) based on its engine displacement (<code>disp</code>, measured in cubic inches), horsepower (<code>hp</code>, measured in… horsepower) and weight (<code>wt</code>, measured in 1000s of pounds).</p>
<p>That is, we want to build a multiple linear regression model of the form <span class="math display">\[
\text{qsec} = \beta_0 + \beta_1 \text{disp} + \beta_2 \text{hp} + \beta_3 \text{wt} + \epsilon
\]</span></p>
<p>To fit such a model in R, the syntax is quite similar to the simple linear regression case. The only thing that changes is that we need to specify this model in R’s notation. We do that via <code>qsec ~ 1 + disp + hp + wt</code>.</p>
<p>Let’s fit the model in R and see what happens.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>mtc_model <span class="ot">&lt;-</span> <span class="fu">lm</span>( qsec <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> disp <span class="sc">+</span> hp <span class="sc">+</span> wt, <span class="at">data=</span>mtcars);</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mtc_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = qsec ~ 1 + disp + hp + wt, data = mtcars)

Residuals:
    Min      1Q  Median      3Q     Max 
-1.8121 -0.3125 -0.0245  0.3544  3.3693 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 17.965050   0.849663  21.144  &lt; 2e-16 ***
disp        -0.006622   0.004166  -1.590  0.12317    
hp          -0.022953   0.004603  -4.986 2.88e-05 ***
wt           1.485283   0.429172   3.461  0.00175 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.062 on 28 degrees of freedom
Multiple R-squared:  0.6808,    Adjusted R-squared:  0.6466 
F-statistic: 19.91 on 3 and 28 DF,  p-value: 4.134e-07</code></pre>
</div>
</div>
<p>Once again, before we get too eager about interpreting the model, we should check that our residuals are reasonable.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(mtc_model<span class="sc">$</span>residuals)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="prediction2_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Hmm… that isn’t amazing, but on the other hand, there aren’t very many observations to begin with, so we shouldn’t expect a particularly normal-looking histogram.</p>
<p>Checking heteroscedasticity isn’t so easy now, but we can still do things like compare the residuals with a normal via a Q-Q plot:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mtc_model, <span class="at">which=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="prediction2_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>In my opinion, this Q-Q plot would likely lead me to question the assumption of normal errors. That doesn’t mean that we can’t proceed with using our linear model, but it will mean that we should be a bit careful with how much credence we give to any quantities that depend on our normality assumption (e.g., our p-values).</p>
<p>Let’s press on regardless, for now, mostly for the sake of demonstration of what we <em>would</em> do, if we were reasonably happy with our model assumptions. Still, we should bear in the back of our minds that perhaps our normality assumptions aren’t exactly true.</p>
<p>Let’s return to our model output.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mtc_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = qsec ~ 1 + disp + hp + wt, data = mtcars)

Residuals:
    Min      1Q  Median      3Q     Max 
-1.8121 -0.3125 -0.0245  0.3544  3.3693 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 17.965050   0.849663  21.144  &lt; 2e-16 ***
disp        -0.006622   0.004166  -1.590  0.12317    
hp          -0.022953   0.004603  -4.986 2.88e-05 ***
wt           1.485283   0.429172   3.461  0.00175 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.062 on 28 degrees of freedom
Multiple R-squared:  0.6808,    Adjusted R-squared:  0.6466 
F-statistic: 19.91 on 3 and 28 DF,  p-value: 4.134e-07</code></pre>
</div>
</div>
<p>Scanning our way up the model summary, let’s look at the table of coefficient estimates. We see that our intercept term and the coefficients for horsepower (<code>hp</code>) and weight (<code>wt</code>) are flagged as being significant. Thus, briefly putting on our testing hats, we would reject the null hypotheses <span class="math inline">\(H_0 : \beta_0=0\)</span>, <span class="math inline">\(H_0: \beta_{\text{hp}} = 0\)</span> and <span class="math inline">\(H_0: \beta_{\text{wt}} = 0\)</span>. On the other hand, there is insufficient evidence to reject the null <span class="math inline">\(H_0 : \beta_{\text{wt}} = 0\)</span>.</p>
<p>In other words, it appears that horsepower and weight are associated with changes in quarter-mile time, but displacement is not.</p>
</section>
<section id="interpreting-estimated-coefficients" class="level3" data-number="28.1.3">
<h3 data-number="28.1.3" class="anchored" data-anchor-id="interpreting-estimated-coefficients"><span class="header-section-number">28.1.3</span> Interpreting estimated coefficients</h3>
<p>In the case of simple linear regression, our interpretation of an estimated slope <span class="math inline">\(\hat{\beta}_1\)</span> was that an increase of one unit in our predictor was associated with an increase of <span class="math inline">\(\hat{\beta}_1\)</span> in our response.</p>
<p>What do our estimated coefficients mean when we have multiple predictors instead of just one?</p>
<p>Well, the interpretation is <em>almost</em> exactly the same. Let’s consider one of the coefficients in our model.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mtc_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = qsec ~ 1 + disp + hp + wt, data = mtcars)

Residuals:
    Min      1Q  Median      3Q     Max 
-1.8121 -0.3125 -0.0245  0.3544  3.3693 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 17.965050   0.849663  21.144  &lt; 2e-16 ***
disp        -0.006622   0.004166  -1.590  0.12317    
hp          -0.022953   0.004603  -4.986 2.88e-05 ***
wt           1.485283   0.429172   3.461  0.00175 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.062 on 28 degrees of freedom
Multiple R-squared:  0.6808,    Adjusted R-squared:  0.6466 
F-statistic: 19.91 on 3 and 28 DF,  p-value: 4.134e-07</code></pre>
</div>
</div>
<p>Our estimate for the <code>wt</code> coefficient is about <span class="math inline">\(1.5\)</span> (we’re rounding here just to avoid writing a bunch of numbers again and again).</p>
<p>If this were simple linear regression, we would say that a unit increase in weight is associated with an increase of <span class="math inline">\(1.5\)</span> seconds in <code>qsec</code> time. But this isn’t simple linear regression– we have other predictors in our model. In particular, we have coefficients corresponding to engine size (<code>disp</code>) and horsepower (<code>hp</code>). That is, our estimated coefficient of <code>wt</code> is the increase in <code>qsec</code> associated with a unit increase of <code>wt</code> <em>while holding <code>hp</code> and <code>disp</code> fixed</em>.</p>
<p>Typically, say something like “controlling for <code>hp</code> and <code>disp</code>, a unit increase of <code>wt</code> is associated with an increase of <span class="math inline">\(1.5\)</span> in <code>qsec</code>”.</p>
</section>
</section>
<section id="assessing-model-fit" class="level2" data-number="28.2">
<h2 data-number="28.2" class="anchored" data-anchor-id="assessing-model-fit"><span class="header-section-number">28.2</span> Assessing model fit</h2>
<p>Once we’ve fit a model to the data, how do we tell if our model is good or not? It’s a trickier question that it might seem at first, and we’ll have lots more to say about the problem in coming weeks. For now, though, let’s consider the most obvious answer to this question.</p>
<p>We fit our model to the data by minimizing the sum of squares (we’re sticking with simple linear regression here for simplicity– this idea extends to multiple linear regression in the obvious way), <span class="math display">\[
\ell( \beta_0, \beta_1 )
= \sum_{i=1}^n (y_i - \hat{y}_i)^2
= \sum_{i=1}^n \left( y_i - (\beta_0 + \beta_1 x_i) \right)^2.
\]</span></p>
<p>So what better way to measure how good our model is than using precisely this quantity, as achieved by our fitted model?</p>
<section id="assessing-model-fit-with-rss" class="level3" data-number="28.2.1">
<h3 data-number="28.2.1" class="anchored" data-anchor-id="assessing-model-fit-with-rss"><span class="header-section-number">28.2.1</span> Assessing model fit with RSS</h3>
<p>We define the residual sum of squares (RSS; also called the sum of squared errors, SSE) to be the sum of squared residuals between our model and the true responses. That is, letting <span class="math inline">\(\hat{\beta}_0\)</span> and <span class="math inline">\(\hat{\beta}_1\)</span> be our estimates of the coefficients, <span class="math display">\[
\operatorname{RSS}
=
\operatorname{SSE}
=
\sum_{i=1}^n (y_i - \hat{y}_i)^2
=
\sum_{i=1}^n \left(y_i - (\hat{\beta}_0 + \hat{\beta}_1 x_i) \right)^2.
\]</span></p>
<p>Okay, but suppose that we fit our model and we get a particular RSS, say, 55. How do we tell whether a particular RSS is large or small? Well, before we even get to that, there are two problems, here.</p>
<ol type="1">
<li><p>We really ought to renormalize that sum– otherwise, models fit with more observations will tend to trivially have larger RSS. Further, if we have more parameters (i.e., more coefficients, i.e., more predictors) in our model, we are going to be able to trivially reduce the RSS. This is a subtle point, and we’ll discuss it in detail when we talk about model selection and cross validation in a few weeks. The important point for now is that instead of looking at the RSS, we adjust the RSS by dividing it by the <em>degrees of freedom</em> of our model: <span class="math inline">\(n-(p+1)\)</span>: <span class="math display">\[
\frac{ \operatorname{RSS} }{ \operatorname{df} }
=
\frac{1}{n-(p+1)} \sum_{i=1}^n \left( \hat{y}_i - y_i \right)^2
\]</span> Remember, generally speaking, our degrees of freedom are the number of data points, less the number of parameters: <span class="math inline">\(n-(p+1)\)</span>, if <span class="math inline">\(p\)</span> is the number of predictors (and an additional <span class="math inline">\(1\)</span> for the intercept term). So a model with more parameters will have a smaller denominator in that expression, and will have a larger RSS. That is, the denominator is smaller when we have more parameters available to our model.</p></li>
<li><p>RSS is a sum of squares. So, like a variance, it is, in a certain sense, of the wrong units to be measuring the “size” of our error. So let’s take the square root of our (renormalized) RSS: <span class="math display">\[
\sqrt{ \frac{ \operatorname{RSS} }{ \operatorname{df} } }
=
\sqrt{ \frac{ \sum_{i=1}^n (y_i - \hat{y}_i)^2 }{ n-(p+1) } }
\]</span> This quantity is the <em>residual standard error</em> (RSE), and it is reported in the chunk of information at the bottom of our model summary:</p></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mtc_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = qsec ~ 1 + disp + hp + wt, data = mtcars)

Residuals:
    Min      1Q  Median      3Q     Max 
-1.8121 -0.3125 -0.0245  0.3544  3.3693 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 17.965050   0.849663  21.144  &lt; 2e-16 ***
disp        -0.006622   0.004166  -1.590  0.12317    
hp          -0.022953   0.004603  -4.986 2.88e-05 ***
wt           1.485283   0.429172   3.461  0.00175 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.062 on 28 degrees of freedom
Multiple R-squared:  0.6808,    Adjusted R-squared:  0.6466 
F-statistic: 19.91 on 3 and 28 DF,  p-value: 4.134e-07</code></pre>
</div>
</div>
<p>The residual standard error is listed as being 1.062, and as being the residual standard error on 28 degrees of freedom. Remember that most typically, the degrees of freedom of a model (any model, not just linear regression) will be the number of data points less the number of parameters we estimate. In this case, there are 32 data points</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(mtcars)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 32</code></pre>
</div>
</div>
<p>and our model has four parameters: the intercept and our three predictors’ coefficients, so 28 degrees of freedom checks out!</p>
</section>
<section id="what-constitutes-a-good-fit" class="level3" data-number="28.2.2">
<h3 data-number="28.2.2" class="anchored" data-anchor-id="what-constitutes-a-good-fit"><span class="header-section-number">28.2.2</span> What constitutes a good fit?</h3>
<p>Ideally, we want the RSE to be small– after all, it measures the error in our model. But how small is small? What number should we compare it to? Well, in a certain sense, the sum of squared residuals is a measure of how much variance is in the responses that is <em>not explained</em> by our model: <span class="math display">\[
\sum_{i=1}^n \left( y_i - \hat{y}_i \right)^2
\]</span></p>
<p>We need a number to compare this against. But what would this be? Well, ideally, we would like to compare this error against that of another model, and why not (almost) the dumbest model of all: the model with no predictors, just an intercept.</p>
<p>Recall from last week’s lecture that we determined that if we <em>couldn’t</em> use any predictors, and were only allowed an intercept term, then we should choose <span class="math display">\[
\hat{\beta}_0 = \bar{y}.
\]</span></p>
<p>In other words, the “dumbest” model (okay, I’m sure we could come up with even sillier models if we put our minds to it, but bear with me!) is one that just predicts the sample mean of the responses <em>regardless</em> of the value of the predictor(s).</p>
<p>If we used this model, we would obtain a sum of squared residuals given by <span class="math display">\[
\sum_{i=1}^n \left(y_i - \bar{y} \right)^2.
\]</span></p>
<p>This quantity is called the <em>total sum of squares</em> (TSS), and you’ve seen it before, though it was kind of hiding…</p>
</section>
<section id="assessing-model-fit-with-r2" class="level3" data-number="28.2.3">
<h3 data-number="28.2.3" class="anchored" data-anchor-id="assessing-model-fit-with-r2"><span class="header-section-number">28.2.3</span> Assessing model fit with <span class="math inline">\(R^2\)</span></h3>
<p>With the RSS and TSS in hand, we can define the <a href="https://en.wikipedia.org/wiki/Coefficient_of_determination">coefficient of determination</a>, or <span class="math inline">\(R\)</span>-squared:</p>
<p><span class="math display">\[
R^2=\frac{\text{TSS}-\text{RSS}}{\text{TSS}}=1-\frac{\text{RSS}}{\text{TSS}},
\]</span></p>
<p>where, as a reminder, <span class="math display">\[
\operatorname{TSS}=\sum_{i=1}^{n}\left(y_{i}-\bar{y}\right)^{2}
\]</span></p>
<p>is the <strong>total sum of squares</strong> and <span class="math display">\[
\operatorname{RSS}=\sum_{i=1}^{n}\left(y_{i}-\hat{y}_i \right)^{2}
\]</span> is the residual sum of squares.</p>
<p>If we think of 1. RSS as being the amount of variation in the data <em>not</em> captured by our model, and 2. TSS as being the amount of variation in the data (once we get rid of the structure explained by the “dumbest” model),</p>
<p>then <span class="math inline">\(1 - \operatorname{RSS}/\operatorname{TSS}\)</span> is the proportion of the variation that <em>is</em> explained by our model.</p>
<p>In the case of simple linear regression, things simplify so that <span class="math inline">\(R^{2}=r^{2}\)</span>, where <span class="math inline">\(r\)</span> is the correlation coefficient between the predictors and responses: <span class="math display">\[
r
=\frac{\sum_{i=1}^{n}\left(x_{i}-\bar{x}\right)\left(y_{i}-\bar{y}\right)}
{\sqrt{\sum_{i=1}^{n}\left(x_{i}-\bar{x}\right)^{2}} \sqrt{\sum_{i=1}^{n}\left(y_{i}-\bar{y}\right)^{2}}}
\]</span></p>
<p>When <span class="math inline">\(R^2\)</span> is close to 1, we can be confident that our linear model is accurately capturing the structure (i.e., variation) in the data.</p>
</section>
<section id="assessing-fit-another-way-mss" class="level3" data-number="28.2.4">
<h3 data-number="28.2.4" class="anchored" data-anchor-id="assessing-fit-another-way-mss"><span class="header-section-number">28.2.4</span> Assessing fit another way: MSS</h3>
<p>Let’s consider a different kind of sum of squares: the sum of squares between <em>our model</em> and the “dumbest” model: <span class="math display">\[
\sum_{i=1}^n \left( \hat{y}_i - \bar{y} \right)^2.
\]</span></p>
<p>This quantity is often called the <em>model sum of squares</em> (MSS) or the <em>explained sum of squares</em> (ESS). These names will make more sense when you revisit these quantities in a mathematical statistics course– the short version is that this measures the amount of variation in the data explained by our model– it’s like a variance of our model’s predictions.</p>
<p>As an aside, we can show (if you’re bored, give it a try) that <span class="math display">\[
\operatorname{TSS} = \operatorname{RSS} + \operatorname{MSS},
\]</span> so that <span class="math display">\[
R^2=\frac{\text{TSS}-\text{RSS}}{\text{TSS}}=\frac{\text{MSS}}{\text{TSS}},
\]</span> Again, that means we can interpret <span class="math inline">\(R^2\)</span> as measuring the proportion (between 0 and 1) of the variation in the responses (TSS) that is explained by our model.</p>
<p>If our model is a good fit to the data, the MSS should be large, while the RSS should be small. So a sensible number to look at is the ratio of these two different sums of squared errors, each adjusted for their degrees of freedom: <span class="math display">\[
\frac{ \operatorname{MSS}/p }{ \operatorname{RSS}/(n-p-1) }.
\]</span></p>
<p>In fact, in the setting where our noise terms <span class="math inline">\(\epsilon_i\)</span> are independent normals with shared mean <span class="math inline">\(0\)</span> and shared variance <span class="math inline">\(\sigma^2\)</span>, this ratio follows a specific distribution: the <a href="https://en.wikipedia.org/wiki/F-distribution">F-distribution</a></p>
</section>
<section id="assessing-model-fit-with-the-f-distribution" class="level3" data-number="28.2.5">
<h3 data-number="28.2.5" class="anchored" data-anchor-id="assessing-model-fit-with-the-f-distribution"><span class="header-section-number">28.2.5</span> Assessing model fit with the F-distribution</h3>
<p>If we look at the very bottom of our model summary, we’ll see a mention of an F-statistic:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mtc_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = qsec ~ 1 + disp + hp + wt, data = mtcars)

Residuals:
    Min      1Q  Median      3Q     Max 
-1.8121 -0.3125 -0.0245  0.3544  3.3693 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 17.965050   0.849663  21.144  &lt; 2e-16 ***
disp        -0.006622   0.004166  -1.590  0.12317    
hp          -0.022953   0.004603  -4.986 2.88e-05 ***
wt           1.485283   0.429172   3.461  0.00175 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.062 on 28 degrees of freedom
Multiple R-squared:  0.6808,    Adjusted R-squared:  0.6466 
F-statistic: 19.91 on 3 and 28 DF,  p-value: 4.134e-07</code></pre>
</div>
</div>
<p>The <a href="https://en.wikipedia.org/wiki/F-distribution">F-distribution</a> is another one of those classic random variables that arise when we look at estimating variance. Just as the T-distribution arises when we look at a ratio of a normal to an estimated variance, something like <span class="math display">\[
\frac{ \bar{X} - \mu }{ \frac{1}{n}\sum_i( X_i - \bar{X})^2 },
\]</span> the F-distribution arises when we look at a ratio of variance estimates, like <span class="math display">\[
\frac{ \frac{1}{n} \sum_i (U_i - \bar{U})^2}{ \frac{1}{m}\sum_j(V_j - \bar{V})^2 }.
\]</span></p>
<p>Its behavior is governed by two degree-of-freedom parameters, one describing the numerator and one describing the denominator. You’ll learn a lot more about the F-distribution when you learn about analysis of variance (ANOVA) in later classes. In our case, we are looking at the ratio <span class="math display">\[
\frac{ \operatorname{MSS}/p }
  { \operatorname{RSS}/(n-p-1) }
= \frac{ \frac{1}{p} \sum_{i=1}^n \left( \hat{y}_i - \bar{y}\right)^2 }
{  \frac{1}{n-p-1} \sum_{i=1}^n \left( y_i - \hat{y}_i \right)^2 },
\]</span> which is a ratio of “means” of squared errors (i.e., variance-like things!). After a bit of algebra (which will have to wait for a mathematical statistics class, I’m afraid), we can show that this ratio is equivalent to a ratio of sample variances.</p>
<p>The important part is that under the null hypothesis in which all of the coefficients predictors are zero, <span class="math display">\[
H_0 : \beta_0 = \beta_1 = \cdots = \beta_p = 0,
\]</span></p>
<p>our ratio of squared error terms will follow an F-distribution with parameters given by <span class="math inline">\((n-p-1)\)</span> and <span class="math inline">\(p\)</span>. Knowing this distribution, we can test the null hypothesis above, and associate a p-value with the null hypothesis that our model has <em>no explanatory power</em>.</p>
<p>Looking at our model summary again,</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mtc_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = qsec ~ 1 + disp + hp + wt, data = mtcars)

Residuals:
    Min      1Q  Median      3Q     Max 
-1.8121 -0.3125 -0.0245  0.3544  3.3693 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 17.965050   0.849663  21.144  &lt; 2e-16 ***
disp        -0.006622   0.004166  -1.590  0.12317    
hp          -0.022953   0.004603  -4.986 2.88e-05 ***
wt           1.485283   0.429172   3.461  0.00175 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.062 on 28 degrees of freedom
Multiple R-squared:  0.6808,    Adjusted R-squared:  0.6466 
F-statistic: 19.91 on 3 and 28 DF,  p-value: 4.134e-07</code></pre>
</div>
</div>
<p>the F-statistic associated with our residuals has a very small p-value associated to it, indicating, in essence, that our model fit is much better than would be expected by chance. Said another way, we can be fairly confident that our model has captured a trend present in our data.</p>
</section>
</section>
<section id="looking-ahead-model-selection" class="level2" data-number="28.3">
<h2 data-number="28.3" class="anchored" data-anchor-id="looking-ahead-model-selection"><span class="header-section-number">28.3</span> Looking ahead: model selection</h2>
<p>One important point that we’ve ignored in our discussion above is how we go about choosing what predictors to include in our model. For example, the <code>mtcars</code> data set has columns</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(mtcars)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "mpg"  "cyl"  "disp" "hp"   "drat" "wt"   "qsec" "vs"   "am"   "gear"
[11] "carb"</code></pre>
</div>
</div>
<p>In our example above, we just chose a few of these to use as predictors. But suppose that we didn’t know ahead of time which predictors to use. How do we choose which ones to include in our model? Are there downsides to just including all of them? We’ll discuss this in great detail in a couple of weeks when we discuss <em>model selection</em> and <em>cross validation</em>, a general set of tools for deciding what predictors to keep in a model and which to discard.</p>
</section>
<section id="mo-predictors-mo-problems" class="level2" data-number="28.4">
<h2 data-number="28.4" class="anchored" data-anchor-id="mo-predictors-mo-problems"><span class="header-section-number">28.4</span> Mo’ predictors mo’ problems</h2>
<p>We’ve seen that extending simple linear regression to multiple linear regression opens up a realm of possibilities for us to incorporate additional information into our models, but this comes at the cost of a few possible pitfalls, which we’ll briefly outline below.</p>
<p>Before we turn to that, let’s take a quick detour to discuss an important trick that lets us include categorical random variables in our regressions.</p>
<section id="handling-categorical-predictors" class="level3" data-number="28.4.1">
<h3 data-number="28.4.1" class="anchored" data-anchor-id="handling-categorical-predictors"><span class="header-section-number">28.4.1</span> Handling categorical predictors</h3>
<p>Suppose that our long-standing client Catamaran wants to predict spending habits of its customers. For each customer in their database, they know whether or not that customer owns one or more cats, and whether or not they own one or more dogs. This indication of whether or not a customer owns cats (or dogs) is categorical, and it isn’t obvious at first how to incorporate this information into a linear regression model.</p>
<p>The trick is to do something very simple: let’s include two predictors: <span class="math display">\[
x_{i,1} = \begin{cases} 1 &amp; \mbox{ if customer } i \text{ owns one or more cats} \\
        0 &amp; \mbox { otherwise. }
        \end{cases}
\]</span> and <span class="math display">\[
x_{i,2} = \begin{cases} 1 &amp; \mbox{ if customer } i \text{ owns one or more dogs} \\
        0 &amp; \mbox { otherwise. }
        \end{cases}
\]</span></p>
<p>Then, our model might be something like <span class="math display">\[
y_i =\beta_0 + \beta_1 x_{i,1} + \beta_2 x_{i,2}.
\]</span> Our predicted spending by a customer who owns cats but no dogs would be <span class="math display">\[
\beta_0 + \beta_1,
\]</span> while our prediction for a customer who owns dogs but not cats would be <span class="math display">\[
\beta_0 + \beta_2,
\]</span> and our prediction for a customer who owns both cats and dogs would be <span class="math display">\[
\beta_0 + \beta_1 + \beta_2.
\]</span></p>
<p>These binary variables encoding our categorical variables are often called <em>dummy</em> variables in the literature, especially in the social sciences.</p>
<p>The especially nice thing here is that our interpretation of the coefficients as “the change in response to a unit increase” can be retained: <span class="math inline">\(\beta_1\)</span> is the (expected) change in spending associated with a “unit increase” in the “customer owns cats” variable. A unit increase in this variable (i.e., from 0 to 1) is just going from “no cats” to “owns one or more cats”.</p>
<p><strong>Example: <code>mtcars</code> revisited.</strong> Returning to the <code>mtcars</code> dataset, notice that there are a couple of binary predictors: <code>vs</code> (the engine shape, i.e., cylinder configuration; <code>0</code> for “V”-shaped, <code>1</code> for “straight”) and <code>am</code> (transmission type; <code>0</code> for automatic, <code>1</code> for manual). Let’s plot the <code>mtcars</code> data, and see how <code>qsec</code> varies with these two categories:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>pp <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(mtcars, <span class="fu">aes</span>( <span class="at">x=</span><span class="fu">as.factor</span>(vs), <span class="at">y=</span>qsec,</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>                          <span class="at">color=</span><span class="fu">as.factor</span>(am),</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>                          <span class="at">fill=</span><span class="fu">as.factor</span>(am))) <span class="sc">+</span> <span class="fu">geom_point</span>();</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>pp</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="prediction2_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Let’s see what happens when we fit a model using these two binary predictors.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>mtc_bin <span class="ot">&lt;-</span> <span class="fu">lm</span>( qsec <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> am <span class="sc">+</span> vs, <span class="at">data=</span>mtcars );</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mtc_bin)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = qsec ~ 1 + am + vs, data = mtcars)

Residuals:
     Min       1Q   Median       3Q      Max 
-1.77902 -0.37789  0.01687  0.65157  2.91187 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  17.1303     0.2754  62.195  &lt; 2e-16 ***
am           -1.3091     0.3791  -3.453  0.00172 ** 
vs            2.8579     0.3753   7.614 2.15e-08 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.038 on 29 degrees of freedom
Multiple R-squared:  0.6842,    Adjusted R-squared:  0.6624 
F-statistic: 31.41 on 2 and 29 DF,  p-value: 5.519e-08</code></pre>
</div>
</div>
<p>Looks like both engine shape and transmission type are useful predictors!</p>
<p>What if we have a category with more than two levels, like demographic information? For example, what if we have survey data in which respondents list what state they live in, and we would like to include that information in our regression?</p>
<p>Well, for each possible category, we can create a binary predictor. So, for example, for each state we could create a predictor that is 1 if the person lives in that state, and zero otherwise. Of course, this is going to result in creating an awful lot of predictors, but that’s a matter that we’ll handle in a few weeks when we discuss model selection and cross validation.</p>
</section>
</section>
<section id="interactions" class="level2" data-number="28.5">
<h2 data-number="28.5" class="anchored" data-anchor-id="interactions"><span class="header-section-number">28.5</span> Interactions</h2>
<p>Let’s look at that <code>mtcars</code> plot again with our two binary predictors.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>pp <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(mtcars, <span class="fu">aes</span>( <span class="at">x=</span><span class="fu">as.factor</span>(vs), <span class="at">y=</span>qsec,</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>                          <span class="at">color=</span><span class="fu">as.factor</span>(am),</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>                          <span class="at">fill=</span><span class="fu">as.factor</span>(am))) <span class="sc">+</span> <span class="fu">geom_point</span>();</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>pp</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="prediction2_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>It looks to me like among cars with <code>vs=0</code>, the cars with <code>am=0</code> have better <code>qsec</code> than those with <code>am=1</code>, but that the transmission type doesn’t make very much difference for <code>qsec</code> among the cars with <code>vs=1</code> (i.e., straight cylinder configuration).</p>
<p>This is an example of an <em>interaction</em>: the effect of one predictor seems to depend on another predictor.</p>
<p>The similarity to the term “drug interaction” is perhaps the best analogy here. Certain medications will have much stronger or much different effects if they are taken in combination with other medications. For example, people taking <a href="https://en.wikipedia.org/wiki/Warfarin">Warfarin</a>, a blood thinner invented here at UW-Madison, need to be very careful when taking <a href="https://en.wikipedia.org/wiki/Nonsteroidal_anti-inflammatory_drug">NSAIDs</a> such as ibuprofen, because the two drugs interact to cause gastrointestinal bleeding. Either of these two medications in isolation does not drastically increase this risk, but they <em>interact</em> to yield a much higher risk.</p>
<p>So it looks like our two binary predictors have an <em>interaction</em>. How might we include this interaction in our model? Well, the natural way is to create another predictor, given by the <em>product</em> of these two predictors: <span class="math display">\[
y_i =\beta_0 + \beta_1 x_{i,1} + \beta_2 x_{i,2} + \beta_{1,2} x_{i,1} x_{i,2}.
\]</span></p>
<p><strong>Example: raining cats and dogs</strong> Returning to our Catamaran example, consider the fact that people who own both cats and dogs are also more likely to own a lot of other animals (rats, hamsters, horses, goats… whatever), and this might manifest as an interaction between cat ownership and dog ownership wherein people who own cats and dogs spend far more than would be predicted by just summing the effect of cat ownership and the effect of dog ownership.</p>
<p>We can include interactions in our linear models in R by writing the interaction into our model formula. We just write a colon (<code>:</code>) between the two predictors whose interaction we want to include:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>mtc_interact <span class="ot">&lt;-</span> <span class="fu">lm</span>( qsec <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> vs <span class="sc">+</span> am <span class="sc">+</span> vs<span class="sc">:</span>am, <span class="at">data=</span>mtcars );</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mtc_interact);</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = qsec ~ 1 + vs + am + vs:am, data = mtcars)

Residuals:
     Min       1Q   Median       3Q      Max 
-1.80000 -0.35429  0.03786  0.66687  2.93286 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 17.14250    0.30497  56.210  &lt; 2e-16 ***
vs           2.82464    0.50245   5.622 5.09e-06 ***
am          -1.34583    0.52823  -2.548   0.0166 *  
vs:am        0.07869    0.77325   0.102   0.9197    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.056 on 28 degrees of freedom
Multiple R-squared:  0.6843,    Adjusted R-squared:  0.6505 
F-statistic: 20.23 on 3 and 28 DF,  p-value: 3.556e-07</code></pre>
</div>
</div>
<p>Looks like in this case, what looked like an interaction to my eye turned out not to be. We <em>could</em> try only including the interaction term, i.e., fit a model of the form <span class="math display">\[
y_i =\beta_0 + \beta_{1,2} x_{i,1} x_{i,2},
\]</span></p>
<p>but it turns out there’s still no significant effect:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>mtc_inter <span class="ot">&lt;-</span> <span class="fu">lm</span>( qsec <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> am<span class="sc">:</span>vs, <span class="at">data=</span>mtcars);</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mtc_inter)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = qsec ~ 1 + am:vs, data = mtcars)

Residuals:
    Min      1Q  Median      3Q     Max 
-3.1104 -0.7829 -0.1400  0.7097  5.2896 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  17.6104     0.3512  50.146   &lt;2e-16 ***
am:vs         1.0896     0.7509   1.451    0.157    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.756 on 30 degrees of freedom
Multiple R-squared:  0.06559,   Adjusted R-squared:  0.03444 
F-statistic: 2.106 on 1 and 30 DF,  p-value: 0.1571</code></pre>
</div>
</div>
<p>Let’s look at an example where an interaction <em>is</em> present, just to make sure we understand what this usually looks like. This example is due to <a href="https://statisticsbyjim.com/regression/interaction-effects/">Jim Frost</a>, whose statistics tutorials are an especially good resource.</p>
<p>Let’s consider a survey in which we ask people about how much they enjoy different foods and different condiments, and we want to build a model to predict how much people will enjoy their meal given a certain food and a certain condiment. That is, our model looks like <span class="math display">\[
\text{satisfaction}
=
\beta_0
+ \beta_1 * \text{food}
+ \beta_2 * \text{condiment}.
\]</span></p>
<p>For simplicity, let’s assume that our predictors <code>food</code> and <code>condiment</code> each only take two values: <span class="math display">\[
\text{food} \in \{ \text{hot dog}, \text{ice cream} \}
~~~\text{ and }~~~
\text{condiment} \in \{ \text{mustard}, \text{chocolate} \}.
\]</span></p>
<p>Now, someone who gives a high rating for the combination of hot dogs and mustard, and a high rating for ice cream and chocolate <em>may not</em> be so enthusiastic about ice cream with mustard or a hot dog with chocolate. In other words, whether the addition of a condiment increases or decreases a person’s enjoyment of a food <em>depends</em> on the value of the food predictor.</p>
<p>This “it depends” property is almost the definition of an interaction effect.</p>
<p>Let’s download <a href="https://statisticsbyjim.com/wp-content/uploads/2017/10/Interactions_Categorical.csv">this dataset</a> from Jim Frost’s website to have a look.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Note: I've downloaded the file and renamed it as frost_example.csv</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>frost <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">'data/frost_example.csv'</span>);</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(frost)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Enjoyment    Food Condiment
1  81.92696 Hot Dog   Mustard
2  84.93977 Hot Dog   Mustard
3  90.28648 Hot Dog   Mustard
4  89.56180 Hot Dog   Mustard
5  97.67683 Hot Dog   Mustard
6  83.61713 Hot Dog   Mustard</code></pre>
</div>
</div>
<p>Let’s start by plotting this data so we can see the interaction effect for ourselves.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>pp <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(frost, <span class="fu">aes</span>(<span class="at">x=</span>Food, <span class="at">y=</span>Enjoyment, <span class="at">color=</span>Condiment, <span class="at">fill=</span>Condiment));</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>pp <span class="ot">&lt;-</span> pp <span class="sc">+</span> <span class="fu">geom_point</span>()</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>pp</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="prediction2_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>It is pretty clear than when <code>Food=Hot Dog</code>, changing the <code>Condiment</code> predictor from <code>Chocolate</code> to <code>Mustard</code> increases the <code>Enjoyment</code> response, while the opposite pattern holds when <code>Food=Ice Cream</code>. This is the hallmark of an interaction effect.</p>
<p>Let’s wee what happens if we ignore this interaction:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>enjoy_nointer <span class="ot">&lt;-</span> <span class="fu">lm</span>(Enjoyment <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> Food <span class="sc">+</span> Condiment, <span class="at">data=</span>frost)</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(enjoy_nointer)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Enjoyment ~ 1 + Food + Condiment, data = frost)

Residuals:
     Min       1Q   Median       3Q      Max 
-23.0067 -14.3016   0.5382  13.4187  27.0218 

Coefficients:
                 Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)       79.3237     2.9278  27.093   &lt;2e-16 ***
FoodIce Cream     -0.2826     3.3807  -0.084    0.934    
CondimentMustard  -3.7251     3.3807  -1.102    0.274    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 15.12 on 77 degrees of freedom
Multiple R-squared:  0.01561,   Adjusted R-squared:  -0.009958 
F-statistic: 0.6105 on 2 and 77 DF,  p-value: 0.5457</code></pre>
</div>
</div>
<p>Neither the <code>Food</code> nor the <code>Condiment</code> predictor has a significant effect!</p>
<p><strong>Aside:</strong> note that R has changed the names of our predictors a bit! <code>lm()</code> noticed that we had passed categorical data (e.g., <code>Hot Dog</code>, <code>Ice Cream</code>) into the linear regression, and it automatically created a dummy encoding for it. The name <code>FoodIce Cream</code> indicates that R created a dummy variable that is <span class="math inline">\(1\)</span> when <code>Food=Ice Cream</code> and <span class="math inline">\(0\)</span> when <code>Food=Hot Dog</code>.</p>
<p>Now, let’s include the interaction effect:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>enjoy_nointer <span class="ot">&lt;-</span> <span class="fu">lm</span>(Enjoyment <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> Food <span class="sc">+</span> Condiment <span class="sc">+</span> Food<span class="sc">:</span>Condiment, <span class="at">data=</span>frost)</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(enjoy_nointer)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Enjoyment ~ 1 + Food + Condiment + Food:Condiment, 
    data = frost)

Residuals:
   Min     1Q Median     3Q    Max 
-9.068 -3.068 -0.407  2.802 13.015 

Coefficients:
                               Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)                      65.317      1.120   58.34   &lt;2e-16 ***
FoodIce Cream                    27.731      1.583   17.52   &lt;2e-16 ***
CondimentMustard                 24.289      1.583   15.34   &lt;2e-16 ***
FoodIce Cream:CondimentMustard  -56.028      2.239  -25.02   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 5.007 on 76 degrees of freedom
Multiple R-squared:  0.8935,    Adjusted R-squared:  0.8892 
F-statistic: 212.4 on 3 and 76 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p>Wow! Suddenly all our predictors are significant!</p>
<p>You may find it interesting to play around with including or not including other terms here (e.g., what happens if you include the interaction but only one of the <code>Food</code> or <code>Condiment</code> predictors?). You’ll learn plenty more about this in your regression courses and when you discuss analysis of variance (ANOVA) in your later classes.</p>
</section>
<section id="nonlinear-transformations" class="level2" data-number="28.6">
<h2 data-number="28.6" class="anchored" data-anchor-id="nonlinear-transformations"><span class="header-section-number">28.6</span> Nonlinear transformations</h2>
<p>Let’s come back once more to the <code>mtcars</code> data set, and let’s look in particular at <code>mpg</code> (miles per gallon) and <code>hp</code> (horsepower).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>( mtcars<span class="sc">$</span>hp, mtcars<span class="sc">$</span>mpg )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="prediction2_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Let’s fit a linear model to this data and see how things look.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>mtc_lm <span class="ot">&lt;-</span> <span class="fu">lm</span>( mpg <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> hp, <span class="at">data=</span>mtcars );</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>pp <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(mtcars, <span class="fu">aes</span>(<span class="at">x=</span>hp, <span class="at">y=</span>mpg) ) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">'lm'</span>, <span class="at">formula=</span><span class="st">'y~1+x'</span>, <span class="at">se=</span><span class="cn">FALSE</span> );</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>pp</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="prediction2_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>That looks okay, but let’s check the residuals.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>( mtc_lm, <span class="at">which=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="prediction2_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Visually, it looks as though our residuals tend to be positive for small and larger values of our predictor, but negative for mid-range values. This isn’t so surprising if we look a little more closely at our original plotted model overlaid on the observations:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>mtc_lm <span class="ot">&lt;-</span> <span class="fu">lm</span>( mpg <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> hp, <span class="at">data=</span>mtcars );</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>pp <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(mtcars, <span class="fu">aes</span>(<span class="at">x=</span>hp, <span class="at">y=</span>mpg) ) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">'lm'</span>, <span class="at">formula=</span><span class="st">'y~1+x'</span>, <span class="at">se=</span><span class="cn">FALSE</span> );</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>pp</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="prediction2_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>It looks a bit like there is a non-linear trend in our data– as horsepower increases, <code>mpg</code> decreases very quickly at first, and then levels off. That isn’t what we would see if the relationship were simply linear– it’s more in keeping with a nonlinear trend.</p>
<p>It looks to me like</p>
<p>That isn’t the end of the story, though: the curve looks a bit like a quadratic function. So what if we add a squared term to our predictors?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>mtc_lm <span class="ot">&lt;-</span> <span class="fu">lm</span>( mpg <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> hp <span class="sc">+</span> <span class="fu">I</span>(hp<span class="sc">^</span><span class="dv">2</span>), <span class="at">data=</span>mtcars );</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>pp <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(mtcars, <span class="fu">aes</span>(<span class="at">x=</span>hp, <span class="at">y=</span>mpg) ) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">'lm'</span>, <span class="at">formula=</span><span class="st">'y~1+x + I(x^2)'</span>, <span class="at">se=</span><span class="cn">FALSE</span> );</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>pp</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="prediction2_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Definitely a better fit!</p>
<p>Notice that to get our non-linear term <code>hp^2</code> into the model, we had to write our formula as <code>mpg ~ 1 + hp + I(hp^2)</code>. If we just wrote <code>mpg ~ 1 + hp + hp^2</code>, R would parse <code>hp^2</code> as just <code>hp</code>. <code>I(...)</code> prevents this and ensures that R doesn’t clobber the expression inside.</p>
<p>Generally speaking, if you see a non-linear trend in the data, replacing one or more predictors with a nonlinear transformation thereof is usually the easiest solution. Of course, the question of what nonlinear transformation to use is another matter. Almost always, replacing a predictor <code>x</code> with <code>x^2</code> or <code>log(x)</code> will do the trick, but there is a whole toolbox of methods for these kinds of things that you’ll see if you take a regression course later.</p>
</section>
<section id="review" class="level2" data-number="28.7">
<h2 data-number="28.7" class="anchored" data-anchor-id="review"><span class="header-section-number">28.7</span> Review</h2>
<p>In these notes we covered</p>
<ul>
<li>The general multiple regression model</li>
<li>Interpretation of estimated coefficients</li>
<li>Assessing Model fit with <span class="math inline">\(R^2\)</span></li>
<li>MSS and the F Statistic for overall fit</li>
<li>Categorical predictors</li>
<li>Interaction Terms</li>
<li>Nonlinear Transformations</li>
</ul>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
  </div>
  <div class="nav-page nav-page-next">
      <a href="./R09_Multiple_Regression.html" class="pagination-link" aria-label="R10 multiple regression further concepts">
        <span class="nav-page-text"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">R10 multiple regression further concepts</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>